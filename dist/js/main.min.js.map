{"version":3,"sources":["main.js"],"names":["resizeBody","changeHeight","document","window","setTimeout","loom","sketchContainer","controls","settings","settingsToggle","addWeftBtn","querySelector","removeWeftBtns","addWarpBtn","removeWarpBtns","seedInput","slice","generateBtn","luckyBtn","downloadBtn","addEventListener","p5Sketch","args","parseArgs","initLoom","resetLoom","generateFromString","threadWidth","value","threadSpacing","parseFloat","patternWidth","weftColors","input","warps","querySelectorAll","color","row","pattern","warpSettings","threadTotal","patternWidthInput","getRandomNumber","threadWidthInput","threadSpacingInput","lerp","parseInt","i","numWefts","newColor","patternWidthMaxMultiplier","addWeft","perlinWavelength","Math","patternPerlin","perlin1D","newPattern","colors","patternLength","addWarp","n","newElem","weftsInner","template","removeBtn","removeWeft","e","target","parentElement","warpsInner","classList","removeWarp","padThis","saveFrame","now","luckyMode","fileName","seedLength","toggleSettings","seedString","chars","sketch","offsetX","currentY","x","wefts","gap","width","currentWarpIndex","p","y","push","step","draw","currentWarp","Warp","underOrOver","wrapIndex","currentX","startX","endX","Weft","startY","maxWidth","minWidth","endY","getNumWefts","max","min","xmur3","h","imul","limit","seed","C","Z","floor","randomNum","a","b","px","pa","pb","generateRandomColorSet","indexOf","hue","colorSet","variation","schemes","variations","scheme","PRNG","registerEvents","perlinWavelengthMaxMultiplier","patternLengthMin","patternLengthMax","btn","console","credits","init"],"mappings":"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","file":"main.min.js","sourcesContent":["\"use strict\";\n\n(function() {\n\n\t/***************************************\n\t\tCommon methods\n\t***************************************/\n\n\tvar vpWidth = function() { return Math.max(document.documentElement.clientWidth, window.innerWidth || 0); }\n\tvar vpHeight = function() { return Math.max(document.documentElement.clientHeight, window.innerHeight || 0); }\n\n\t\n\tvar init = function() {\n\t\tresizeBody();\n\t\tloom();\n\t\tcredits();\n\t}\n\n\n\n\t/***************************************\n\t\tResize body\n\t***************************************/\n\n\tvar resizeBody = function() {\n\t\tvar changeHeight = function() {\n\t\t\tdocument.documentElement.style.setProperty('--vw', (0.01 * document.body.clientWidth) + 'px');\n\t\t\tdocument.documentElement.style.setProperty('--vh', (0.01 * window.innerHeight) + 'px');\n\t\t\tdocument.body.style.height = window.innerHeight + 'px';\n\t\t}\n\n\t\tsetTimeout(changeHeight, 20); // older Safari iOS will lag\n\t\twindow.addEventListener('resize', changeHeight);\n\t}\n\n\n\n\n\n\t/***************************************\n\t\tLoom\n\t***************************************/\n\n\tvar loom = function() {\n\t\tvar sketchContainer = document.querySelector('.sketch-container'),\n\t\t\tcontrols        = document.querySelector('.controls'),\n\t\t\tsettings        = controls.querySelector('.settings'),\n\t\t\tsettingsToggle  = settings.querySelector('.settings-toggle'),\n\t\t\taddWeftBtn      = controls.querySelector('.add-weft-btn'),\n\t\t\tremoveWeftBtns  = [].slice.call(controls.querySelectorAll('.setting-wefts .remove-btn')),\n\t\t\taddWarpBtn      = controls.querySelector('.add-warp-btn'),\n\t\t\tremoveWarpBtns  = [].slice.call(controls.querySelectorAll('.setting-warps .remove-btn')),\n\t\t\tseedInput       = controls.querySelector('#seed'),\n\t\t\tgenerateBtn     = controls.querySelector('#generate'),\n\t\t\tluckyBtn        = controls.querySelector('#lucky'),\n\t\t\tdownloadBtn     = controls.querySelector('#download'),\n\t\t\targs, p5Sketch;\n\n\t\t// some fixed variables to tweak behaviour\n\t\tvar maxNumWefts                   = 50,\n\t\t\tmaxNumWarps                   = 50,\n\t\t\tmaxThreadWidth                = 20,\n\t\t\tpatternWidthMinMultiplier     = 3,\t\t\t// lower boundary for the pattern width, n * wefts number\n\t\t\tpatternWidthMaxMultiplier     = 10,\t\t\t// upper boundary for the pattern width, n * wefts number\n\t\t\tperlinWavelengthMinMultiplier = 0.05,\t\t// [0, 1[ lower boundary for the Perlin Noise wavelength for the warp length\n\t\t\tperlinWavelengthMaxMultiplier = 0.25,\t\t// ]0, 1] upper boundary for the Perlin Noise wavelength for the warp length\n\t\t\tpatternLengthMin              = 4,\n\t\t\tpatternLengthMax              = 200;\n\n\n\n\t\tvar registerEvents = function() {\n\t\t\tsettingsToggle.addEventListener('click', toggleSettings);\n\t\t\taddWeftBtn.addEventListener(    'click', addWeft);\n\t\t\tremoveWeftBtns.forEach(btn =>\n\t\t\t\tbtn.addEventListener(       'click', removeWeft)\n\t\t\t);\n\t\t\taddWarpBtn.addEventListener(    'click', addWarp);\n\t\t\tremoveWarpBtns.forEach(btn =>\n\t\t\t\tbtn.addEventListener(       'click', removeWarp)\n\t\t\t);\n\n\t\t\tgenerateBtn.addEventListener(   'click', resetLoom);\n\t\t\tluckyBtn.addEventListener(      'click', luckyMode);\n\t\t\tdownloadBtn.addEventListener(   'click', saveFrame);\n\t\t\tcontrols.addEventListener(     'submit', resetLoom);\n\t\t}\n\n\t\tvar initLoom = function() {\n\t\t\targs            = parseArgs();\n\t\t\tp5Sketch        = new p5(sketch, sketchContainer);\n\t\t}\n\n\t\tvar resetLoom = function(e) {\n\t\t\tif (e)\t\t\te.preventDefault();\n\t\t\tif (p5Sketch)\tp5Sketch.remove();\n\n\t\t\tinitLoom();\n\t\t}\n\n\t\tvar parseArgs = function() {\n\t\t\tif (seedInput.value.length > 0)\n\t\t\t\tgenerateFromString(seedInput.value);\n\n\t\t\tlet threadWidth   = parseFloat(document.querySelector('#thread-width').value),\n\t\t\t\tthreadSpacing = parseFloat(document.querySelector('#thread-spacing').value),\n\t\t\t\tpatternWidth  = parseInt(document.querySelector('#pattern-width').value);\n\n\t\t\tlet weftColors    = [].slice.call(controls.querySelectorAll('.setting-wefts .repeater-elements input[type=\"color\"]'))\n\t\t\t\t\t\t\t\t  .map(input => input.value);\n\n\t\t\tlet warps         = [].slice.call(controls.querySelectorAll('.setting-warps .repeater-elements .repeater-single'))\n\t\t\t\t\t\t\t\t  .map(function(row) {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tcolor:   row.querySelector('input[type=\"color\"]').value,\n\t\t\t\t\t\t\t\t\t\t\tpattern: row.querySelector('input[type=\"text\"]').value\n\t\t\t\t\t\t\t\t\t\t\t\t\t    .replace(/[^01]/g, '')\n\t\t\t\t\t\t\t\t\t\t\t\t\t    .split(''),\n\t\t\t\t\t\t\t\t  \t\t}\n\t\t\t\t\t\t\t\t  });\n\n\t\t\treturn {\n\t\t\t\tthreadWidth: \tthreadWidth,\n\t\t\t\tthreadSpacing:\tthreadSpacing,\n\t\t\t\tthreadTotal:    threadWidth + threadSpacing,\n\t\t\t\tpatternWidth:\tpatternWidth,\n\t\t\t\tweftColors: \tweftColors,\n\t\t\t\twarpSettings:   warps \n\t\t\t};\n\t\t}\n\n\t\tvar generateFromString = function(seed) {\n\t\t\tlet threadWidthInput   = document.querySelector('#thread-width'),\n\t\t\t\tthreadSpacingInput = document.querySelector('#thread-spacing'),\n\t\t\t\tpatternWidthInput  = document.querySelector('#pattern-width');\n\n\t\t\t//\tclear everything\n\t\t\tdocument.querySelector('.setting-wefts .repeater-elements').innerHTML = '';\n\t\t\tdocument.querySelector('.setting-warps .repeater-elements').innerHTML = '';\n\n\n\t\t\tlet getRandomNumber = xmur3(seed),\n\t\t\t\tnumWefts        = parseInt(lerp(getRandomNumber(), 1, maxNumWefts)),\n\t\t\t\tnumWarps        = parseInt(lerp(getRandomNumber(), 1, maxNumWarps)),\n\t\t\t\tthreadWidth     = parseInt(lerp(getRandomNumber(), 1, maxThreadWidth)),\n\t\t\t\tthreadSpacing   = parseInt(lerp(getRandomNumber(), 0, 0.5 * threadWidth)),\n\t\t\t\tpatternWidth    = parseInt(lerp(getRandomNumber(), patternWidthMinMultiplier * numWefts, patternWidthMaxMultiplier * numWefts)),\n\t\t\t\tcolors          = generateRandomColorSet(getRandomNumber);\n\n\t\t\tthreadWidthInput.value   = threadWidth;\n\t\t\tthreadSpacingInput.value = threadSpacing;\n\t\t\tpatternWidthInput.value  = patternWidth;\n\n\t\t\tfor (let i = 0; i < numWefts; i++) {\n\t\t\t\tlet newColor = colors[parseInt(lerp(getRandomNumber(), 0, colors.length - 1))];\n\t\t\t\taddWeft(newColor);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < numWarps; i++) {\n\t\t\t\tlet newColor         = colors[parseInt(lerp(getRandomNumber(), 0, colors.length - 1))],\n\t\t\t\t\tpatternLength    = parseInt(lerp(getRandomNumber(), patternLengthMin, patternLengthMax)),\n\t\t\t\t\tperlinWavelength = Math.floor(patternWidth * lerp(getRandomNumber(), perlinWavelengthMinMultiplier, perlinWavelengthMaxMultiplier)),\n\t\t\t\t\tpatternPerlin    = perlin1D(getRandomNumber(), perlinWavelength),\n\t\t\t\t\tnewPattern       = '';\n\n\t\t\t\tfor (let n = 0; n < patternLength; n++) {\n\t\t\t\t\tnewPattern = newPattern + (patternPerlin() < 0.5 ? '0' : '1');\n\t\t\t\t}\n\n\t\t\t\taddWarp(newColor, newPattern);\n\t\t\t}\n\t\t}\n\n\n\n\t\t/***************************************\n\t\t\tInterface\n\t\t***************************************/\n\n\t\tvar addWeft = function(color) {\n\t\t\tlet weftsInner = controls.querySelector('.setting-wefts .repeater-elements'),\n\t\t\t\ttemplate   = controls.querySelector('.setting-wefts .repeater-template'),\n\t\t\t\tnewElem    = template.cloneNode(true),\n\t\t\t\tremoveBtn  = newElem.querySelector('.remove-btn');\n\n\t\t\tnewElem.classList.remove('repeater-template');\n\t\t\tweftsInner.appendChild(newElem);\n\t\t\tremoveBtn.addEventListener('click', removeWeft);\n\n\t\t\tif (color !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"color\"]').value = color;\n\t\t\t}\n\t\t}\n\n\t\tvar removeWeft = function(e) {\n\t\t\tlet row = e.target.closest('.repeater-single');\n\t\t\te.target.removeEventListener('click', removeWeft);\n\t\t\trow.parentElement.removeChild(row);\n\t\t}\n\n\t\tvar addWarp = function(color, pattern) {\n\t\t\tlet warpsInner = controls.querySelector('.setting-warps .repeater-elements'),\n\t\t\t\ttemplate   = controls.querySelector('.setting-warps .repeater-template'),\n\t\t\t\tnewElem    = template.cloneNode(true),\n\t\t\t\tremoveBtn  = newElem.querySelector('.remove-btn');\n\n\t\t\tnewElem.classList.remove('repeater-template');\n\t\t\twarpsInner.appendChild(newElem);\n\t\t\tremoveBtn.addEventListener('click', removeWarp);\n\n\t\t\tif (color !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"color\"]').value = color;\n\t\t\t}\n\n\t\t\tif (pattern !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"text\"]').value = pattern;\n\t\t\t}\n\t\t}\n\n\t\tvar removeWarp = function(e) {\n\t\t\tlet row = e.target.closest('.repeater-single');\n\t\t\te.target.removeEventListener('click', removeWarp);\n\t\t\trow.parentElement.removeChild(row);\n\t\t}\n\n\t\tvar saveFrame = function() {\n\t\t\tlet now      = new Date(),\n\t\t\t\tpadThis  = n => n.toString().padStart(2, '0'),\n\t\t\t\tfileName = seedInput.value.length > 0\n\t\t\t\t\t\t ? 'loom_seed_' + seedInput.value\n\t\t\t\t\t\t : 'loom_'   + now.getFullYear() + '-' + padThis(now.getMonth() + 1) + '-' + padThis(now.getDate())\n\t\t\t\t\t\t + ' ' + padThis(now.getHours()) + '-' + padThis(now.getMinutes())   + '-' + padThis(now.getSeconds());\n\t\t\tp5Sketch.save(fileName + '.jpg');\n\t\t}\n\n\t\tvar toggleSettings = function() {\n\t\t\tsettings.classList.toggle('show-settings');\n\t\t}\n\n\t\tvar luckyMode = function() {\n\t\t\tvar seedLength = parseInt(lerp(Math.random(), 1, 100)),\n\t\t\t\tseedString = '',\n    \t\t\tchars      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n\t\t\tfor (var i = 0; i < seedLength; i++) {\n\t\t\t\tseedString += chars.charAt(Math.floor(Math.random() * chars.length));\n\t\t\t}\n\n\n\t\t\tseedInput.value = seedString; // hacky but I don't care, it's late\n\t\t\tresetLoom();\n\t\t}\n\n\n\n\t\t/***************************************\n\t\t\tDrawing\n\t\t***************************************/\n\n\t\tvar sketch = function(p) {\n\t\t\tlet wefts         = [],\n\t\t\t\tnumWefts,\n\t\t\t\twarps         = [];\n\n\t\t\tvar\toffsetX          = 0.5 * args.threadWidth,\n\t\t\t\tcurrentY         = 0,\n\t\t\t\tcurrentWarpIndex = 0;\n\n\t\t\tp.setup = function() {\n\t\t\t\tp.createCanvas(sketchContainer.clientWidth, sketchContainer.clientHeight);\n\t\t\t\tnumWefts = getNumWefts();\n\n\t\t\t\tfor (let x = 0; x < numWefts; x++) {\n\t\t\t\t\twefts.push(new Weft({\n\t\t\t\t\t\tx:    \t\tx * args.threadTotal + offsetX, // offset because stroke is drawn centered\n\t\t\t\t\t\tcolor:\t\targs.weftColors[x % args.weftColors.length],\n\t\t\t\t\t\tgap:        args.threadSpacing,\n\t\t\t\t\t\tstep:       args.threadTotal,\n\t\t\t\t\t\twidth:\t\targs.threadWidth\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tfor (let y = 0; y < args.warpSettings.length; y++) {\n\t\t\t\t\twarps.push(new Warp({\n\t\t\t\t\t\tcolor:  \targs.warpSettings[y].color,\n\t\t\t\t\t\tgap:        args.threadSpacing,\n\t\t\t\t\t\tstep:       args.threadTotal,\n\t\t\t\t\t\twidth:  \targs.threadWidth,\n\t\t\t\t\t\tnumWefts:   numWefts,\n\t\t\t\t\t\tpattern:\targs.warpSettings[y].pattern\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tp.background(255);\n\t\t\t}\n\n\n\t\t\t/***************************************\n\t\t\t\tDraw row by row\n\t\t\t***************************************/\n\n\t\t\tp.draw = function() {\n\t\t\t\tif (currentY * args.threadTotal > p.height)\n\t\t\t\t\treturn p.noLoop();\n\n\t\t\t\tlet currentWarp = warps[currentWarpIndex];\n\n\t\t\t\tfor (var x = 0; x < numWefts; x++) {\n\t\t\t\t\tlet underOrOver = currentWarp.weave(x, currentY);\n\t\t\t\t\tif (underOrOver == 'under')\n\t\t\t\t\t \twefts[x].weave(currentY);\n\t\t\t\t}\n\n\t\t\t\tcurrentWarpIndex = wrapIndex(currentWarpIndex + 1, 0, args.warpSettings.length - 1);\n\t\t\t\tcurrentY++;\n\t\t\t}\n\n\n\t\t\t/***************************************\n\t\t\t\tWarps: horizontal threads\n\t\t\t***************************************/\n\n\t\t\tclass Warp {\n\t\t\t\tconstructor(args) {\n\t\t\t\t\tthis.args            = args;\n\t\t\t\t\tthis.counter         = 0;\n\t\t\t\t}\n\n\t\t\t\tweave(currentX, currentY) {\n\t\t\t\t\tthis.counter = wrapIndex(this.counter + 1, 0, this.args.pattern.length - 1);\n\n\t\t\t\t//\tgo under?\n\t\t\t\t\tif (this.args.pattern[this.counter] == 0)\n\t\t\t\t\t\treturn 'under';\n\n\t\t\t\t//\tgo over!\n\t\t\t\t\tlet\tstartX =  currentX      * this.args.step - this.args.gap,\n\t\t\t\t\t\tendX   = (currentX + 1) * this.args.step,\n\t\t\t\t\t\ty      = currentY * this.args.step + 0.5 * (this.args.width);\n\n\t\t\t\t\tp.strokeCap(p.SQUARE);\n\t\t\t\t\tp.strokeWeight(this.args.width);\n\t\t\t\t\tp.stroke(this.args.color);\n\t\t\t\t\tp.line(startX, y, endX, y);\n\t\t\t\t\treturn 'over';\n\t\t\t\t}\n\t\t\t}\n\n\n\n\t\t\t/***************************************\n\t\t\t\tWefts: vertical threads\n\t\t\t***************************************/\n\n\t\t\tclass Weft {\n\t\t\t\tconstructor(args) {\n\t\t\t\t\tthis.args  = args;\n\t\t\t\t}\n\n\t\t\t\tweave(currentY) {\n\t\t\t\t\tlet startY =  currentY      * this.args.step - this.args.gap,\n\t\t\t\t\t\tendY   = (currentY + 1) * this.args.step + this.args.gap;\n\n\t\t\t\t\tp.strokeCap(p.SQUARE);\n\t\t\t\t\tp.strokeWeight(this.args.width);\n\t\t\t\t\tp.stroke(this.args.color);\n\t\t\t\t\tp.line(this.args.x, startY, this.args.x, endY);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar getNumWefts = function() {\n\t\t\t\tlet minWidth      = Math.floor(p.width / args.threadTotal),\n\t\t\t\t\tmaxWidth      = Math.ceil(minWidth / args.patternWidth) * args.patternWidth + Math.floor(0.5 * args.patternWidth);\n\t\t\t\treturn maxWidth;\n\t\t\t}\n\t\t}\n\n\t\t/***************************************\n\t\t\tHelper functions\n\t\t***************************************/\n\n\t\tvar wrapIndex = function(n, min, max) {\n\t\t\tif (n >= min && n <= max)\treturn n;\n\t\t\tif (n > max)\t\t\t\treturn min;\n\t\t\t\t\t\t\t\t\t\treturn max;\n\t\t}\n\n\t\tvar limit = function(n, min, max) {\n\t\t\treturn Math.min(Math.max(n, min), max);\n\t\t}\n\n\t\tvar lerp = function(n, min, max) {\n        \treturn min + (max - min) * limit(n, 0, 1);\n\t\t}\n\n\t\t// seeded pseudo-random number generator\n\t\tvar xmur3 = function(seed) {\n\t\t\tfor (var i = 0, h = 1779033703 ^ seed.length; i < seed.length; i++) {\n\t\t\t\th = Math.imul(h ^ seed.charCodeAt(i), 3432918353);\n\t\t\t\th = h << 13 | h >>> 19;\n\t\t\t}\n\n\t\t\treturn function() {\n\t\t\t\th = Math.imul(h ^ h >>> 16, 2246822507);\n\t\t\t\th = Math.imul(h ^ h >>> 13, 3266489909);\n\t\t\t\th = (h ^= h >>> 16) >>> 0;\n\t\t\t\treturn h / Math.pow(10, h.toString().length);\n\t\t\t}\n\t\t}\n\n\t\tvar perlin1D = function(seed, wavelength) {\n\t\t\tlet M          = 1853020188851841,\t// 3^30\n\t\t\t    A          = 14348908,\t        // A - 1 has to be divisible by M's prime factors (3^15 + 1)\n\t\t\t    C          = 11, \t\t\t    // C and M are co-prime,\n\t\t\t\tZ          = Math.floor(seed * M),\n\t\t\t\trandomNum  = function() {\n\t\t\t\t\tZ = (A * Z + C) % M;\n\t\t\t\t\treturn Z / M - 0.5;\n\t\t\t\t},\n\t\t\t\th          = 1,\n\t\t\t\tx          = 0,\n\t\t\t\ty          = h / 2,\n\t\t\t\tamplitude  = 100, \t\t\t\t// amplitude\n\t\t\t\ta          = randomNum(),\n\t\t\t\tb          = randomNum();\n\n\t\t\tvar interpolate = function(pa, pb, px) {\n\t\t\t\tvar ft = px * Math.PI,\n\t\t\t\t\tf = (1 - Math.cos(ft)) * 0.5;\n\t\t\t\treturn pa * (1 - f) + pb * f;\n\t\t\t}\n\n\t\t\treturn function() {\n\t\t\t\tif (x % wavelength === 0) {\n\t\t\t\t\ta = b;\n\t\t\t\t\tb = randomNum();\n\t\t\t\t\ty = h / 2 + a * amplitude;\n\t\t\t\t} else {\n\t\t\t\t\ty = h / 2 + interpolate(a, b, (x % wavelength) / wavelength) * amplitude;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tx += 1;\n\t\t\t\treturn y;\n\t\t\t}\n\t\t}\n\n\t\tvar generateRandomColorSet = function(PRNG) {\n\t\t\tlet hue        = parseInt(lerp(PRNG(), 0, 359)),\n\t\t\t\tschemes    = ['mono', 'contrast', 'triade', 'tetrade', 'analogic'],\n\t\t\t\tvariations = ['default', 'pastel', 'soft', 'light', 'hard', 'pale'],\n\t\t\t\tscheme     = schemes[parseInt(lerp(PRNG(), 0, schemes.length - 1))],\n\t\t\t\tvariation  = variations[parseInt(lerp(PRNG(), 0, variations.length - 1))],\n\t\t\t\tcolorSet   = new ColorScheme();\n\n\t\t\tcolorSet.from_hue(hue).scheme(scheme);\n\t\t\tif (['triade', 'tetrade', 'analogic'].indexOf(scheme) > -1)\n\t\t\t\tcolorSet.distance(lerp(PRNG(), 0.25, 0.5));\n\t\t\t\n\t\t\tlet colors = colorSet.variation(variation).colors();\n\t\t\treturn colors.map(color => '#' + color);\n\t\t}\n\n\t\tregisterEvents();\n\t\tluckyMode();\n\t}\n\n\n\n\n\n\n\t/***************************************\n\t\tCredits\n\t***************************************/\n\n\tvar credits = function() {\n\t\tvar credits = '**********\\n\\nThis website was built by Matthias Planitzer.\\nwww.matthias-planitzer.de\\n\\n**********';\n\t\tconsole.log('%c' + credits, 'color: #00F; font-family: Helvetica Neue\", Helvetica, sans-serif; font-size: 14px;');\t\n\t}\n\n\tinit();\n})();"]}