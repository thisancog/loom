{"version":3,"sources":["main.js"],"names":["resizeBody","changeHeight","document","window","setTimeout","loom","sketchContainer","controls","settings","settingsToggle","threadWidthInput","querySelector","threadSpacingInput","patternWidthInput","addWeftBtn","removeWeftBtns","addWarpBtn","removeWarpBtns","seedInput","slice","generateBtn","luckyBtn","downloadBtn","params","random","p5Sketch","maxNumWefts","maxNumWarps","maxThreadWidth","patternWidthMinMultiplier","patternLengthMin","patternWidthMaxMultiplier","addEventListener","args","parseArgs","initLoom","resetLoom","generateFromString","threadWidth","value","threadSpacing","parseFloat","patternWidth","weftColors","input","warps","querySelectorAll","color","row","pattern","warpSettings","threadTotal","getRandomNumber","seeder","algorithms","generateFromStringRandom","parseInt","rand","numWarps","numWefts","newColor","colors","lerp","addWeft","i","generateRandomColorSet","perlinWavelength","patternPerlin","newPattern","patternLength","generateFromStringLinear","Math","perlin1D","weftsInner","n","template","newElem","removeWeft","target","closest","e","removeEventListener","parentElement","removeChild","removeBtn","addWarp","warpsInner","removeWarp","padThis","toggleSettings","saveFrame","seedString","now","chars","fileName","charAt","luckyMode","seedLength","wefts","offsetX","p","setup","gap","step","currentY","width","x","background","y","draw","currentWarp","underOrOver","Warp","currentWarpIndex","wrapIndex","startX","currentX","endX","Weft","maxWidth","startY","endY","getNumWefts","minWidth","xmur3","limit","h","min","max","xoshiro128ss","seed","c","d","b","a","M","t","r","Z","randomNum","amplitude","interpolate","ft","px","f","wavelength","pa","pb","variations","hue","colorSet","ColorScheme","from_hue","scheme","schemes","variation","PRNG","registerEvents","patternLengthMax","btn","credits","console","init"],"mappings":"AAAA,a,kYAEA,CAAC,UAAW,IAUXA,CAAAA,CAAA,CAAAA,UAAA,CAQA,GAAAC,CAAAA,CAAA,CAAAA,UAAA,CACDC,QAAA,CAAAA,eAAAA,CAAAA,KAAAA,CAAAA,WAAAA,CAAAA,MAAAA,CAAA,IAAAA,QAAA,CAAAA,IAAAA,CAAA,WAAA,CAAAA,IAAAA,CADC,CAEDA,QAAA,CAAAA,eAAAA,CAAAA,KAAAA,CAAAA,WAAAA,CAAAA,MAAAA,CAAA,IAAAC,MAAA,CAAA,WAAA,CAAAD,IAAAA,CAFC,CAQEA,QAAQ,CAARA,IAAAA,CAAAA,KAAAA,CAAAA,MAAAA,CAA6BC,MAAM,CAANA,WAAAA,CAA7BD,IARF,CAAA,CAKCE,UAAIH,CAAAA,CAAAA,CAbL,EAaKA,CAbL,CAcEC,MAAAA,CAAAA,gBAAAA,CAAAA,QAAAA,CAAAA,CAAAA,CAVD,CAdU,CAuCZG,CAAA,CAAAA,UAAA,IAGE,CAAA,CAHF,CAAA,CAAA,CAGMC,CAAe,CAAMJ,QAAQ,CAARA,aAAAA,CAAzB,mBAAyBA,CAH3B,CAIGK,CAAQ,CAAaL,QAAQ,CAARA,aAAAA,CADtB,WACsBA,CAJxB,CAECM,CAAQ,CAAJH,CAAkB,CAAlBA,aAAAA,CACH,WADGA,CAFL,CAGEI,CAAIH,CAAeE,CAAMN,CAANM,aAAAA,CAAnB,kBAAmBA,CAHrB,CAGEE,CACsBR,CAAAA,QAASS,CAATT,aAAAA,CADtB,eACsBA,CAJxB,CAGEU,CAEsBL,CAAAA,QAASI,CAATJ,aAAAA,CAFtB,iBAEsBA,CALxB,CAGEM,CAGCJ,CAAcP,QAAOM,CAAPN,aAAAA,CAHf,gBAGeA,CANjB,CAGEY,CAICJ,CAAgBH,CAAKL,CAALK,aAAAA,CAJjB,eAIiBA,CAPnB,CAGEQ,CAKCH,CAAAA,GAAAA,KAAAA,CAAAA,IAAAA,CAA8BD,CAAAA,CAAAA,gBAAAA,CAL/B,4BAK+BA,CAA9BC,CARH,CAGEI,CAMCH,CAAAA,CAAqBX,CAArBW,aAAAA,CAND,eAMCA,CATH,CAGEI,CAOCH,CAAqBP,GAAAA,KAAAA,CAAAA,IAAAA,CAASI,CAAc,CAAdA,gBAAAA,CAP/B,4BAO+BA,CAATJ,CAVxB,CAGEW,CAQCH,CAAcR,CAAUY,CAAVZ,aAAAA,CARf,OAQeA,CAXjB,CAGEa,CASCJ,CAAqBT,CAASI,CAATJ,aAAAA,CATtB,WASsBA,CAZxB,CAGEc,CAUCJ,CAAcV,CAAUY,CAAVZ,aAAAA,CAVf,QAUeA,CAbjB,CAGEe,CAWCJ,CAAqBX,CAASI,CAATJ,aAAAA,CAXtB,WAWsBA,CAdxB,CAGEgB,CAAA,CAAA,CAAAC,MAeOC,CAAAA,CAKJC,WAAW,CALPD,EAAAA,CAGPE,WAAU,CAHHF,EAAAA,CAILD,cAAQ,CAJHC,EAAAA,CAKJC,yBADO,CAJHD,CAAAA,CAMJE,yBAFO,CAJHF,EAAAA,CAOJG,6BAHO,CAJHH,GAAAA,CAQJI,6BAAyB,CARrBJ,EAAAA,CAQ8BK,gBAAA,CAR9BL,CAAAA,CASJM,gBAAAA,CAAAA,EATIN,CAfP,CAHF,CAkDGH,CAAAA,CAAAA,UAAYU,CACZzB,CAAAA,CAASyB,CAATzB,EADYyB,CAEZP,CAfD,CAAA,GAAA,CAAA,EAAA,CAAA,CAAA,CAeCA,CAfD,CAaCH,CAlDH,CAuDGW,CAAkBC,CAAlBD,SAAkBC,CAAlBD,CAAA,CACAR,CADA,EACAA,CAAAA,CAAAA,cAAAA,EADA,CAEA,CAFA,EADDA,CAAA,CAAAA,MAAAA,EACC,CAIDU,CAAIC,EAJHH,CAvDH,CA+DGE,CAAQ,CAARA,UAAQ,CACR,CALDjB,CAAAA,CAAA,CAAAA,KAAAA,CAAAA,MAIS,EAKPmB,CAAkB,CAACnB,CAAS,CAA5BmB,KAAkB,CALX,IAIRC,CAAAA,CAAIpB,CAAUqB,UAAV,CAAArC,QACHmC,CADGnC,aAAAA,CAAAA,eAAAA,EAAJ,KAAI,CAJI,CAORsC,CAAIF,CAAAA,UAAgBG,CAAAA,QAAWvC,CAAXuC,aAAAA,CAAAA,iBAAAA,EAHpB,KAGoBA,CAPZ,CAORC,CACCF,CAAAA,QAAgBC,CAAAA,QAAWvC,CAAXuC,aAAAA,CAAAA,gBAAAA,EAJjB,KAIiBA,CART,CAWRE,CAAIA,CAAgB,GAAA,KAAA,CAAA,IAAA,CAAcpC,CAAQ,CAARA,gBAAAA,CAAd,yDAAcA,CAAd,EAAA,GAAA,CACCqC,SAAAA,CAAAA,CAAK,CAAA,MAACL,CAAAA,CAAV,CAAS,KAD1B,CAAoB,CAXZ,CAcRM,CAAIA,CAAmB1B,GAAAA,KAAAA,CAAAA,IAAAA,CAAWZ,CAASuC,CAATvC,gBAAAA,CAAXY,oDAAWZ,CAAXY,EAAAA,GAAAA,CAET,SAAA,CAAA,CAAA,CACN4B,MAASC,CACTC,KAAAA,CAASD,CAAIrC,CAAJqC,aAAAA,CAAAA,uBAAAA,EADAA,KAAAA,CADVC,OAAA,CAAAD,CAAA,CAAAA,aAAAA,CAAAA,sBAAAA,EAAAA,KAAAA,CAAAA,OAAAA,CAAAA,QAAAA,CAAAA,EAAAA,EAAAA,KAAAA,CAAAA,EAAAA,CACUA,CAHjB,CAAuB7B,CAdf,CA4BPuB,MAAAA,CACAC,WAAAA,CADAD,CAAAA,CAEAQ,aAAAA,CAFAR,CAAAA,CAJMS,WAAP,CAAAb,CAAA,CAICI,CAAAA,CAIDA,YA7BD,CAyBEA,CAAAA,CAOFC,UAAA,CAPED,CAAAA,CAQJQ,YAAA,CAAAL,CARIH,CA5BDP,CA/DH,CA2GGE,CACCe,CADDf,SACgB,CADhBA,CACgCgB,CAMhCC,QAAAA,CAAAA,aAAAA,CAAAA,mCAAAA,EAAAA,SAAAA,CAAAA,EANgCD,CAOhCnD,QAbD,CAaCA,aAAAA,CAAAA,mCAAAA,EAAAA,SAAAA,CAAAA,EAPgCmD,CAUjC,GAAAA,CAAAA,CAAIE,CAAAA,CAAAA,CAAJ,CAAIA,CAAJ,CACCH,CAAY,CAAUI,CAAa,CAACC,CAAD,EAAA,CAAAJ,CAAA,EAAA,CAAmB7B,CAAnB,EAAA,CAA0BE,CAD9D,EACoC,CADpC,CACC4B,CACCI,CAAkBF,CAAAA,CAAAA,CAFpB,CAEoBA,CAFpB,CAQC9C,CAAAA,CAAAA,IAAAA,CAAAA,KAAAA,CAAiB6B,CAAUD,GAA3BgB,CAAA,CAAA5C,MAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAnBA,CA3GH,CAkIG6C,CAAoBI,CAApBJ,SAAoBI,CAApBJ,CAAmC,CAClC,GAAAI,CAAAA,CAAIC,CAAWC,QAAOL,CAAAA,CAAQ,CAACM,CAAD,EAAA,CAAA,CAAA,CAAKvC,CAAYsC,CAAZtC,MAAAA,CAAnC,WAA8B,CAARiC,CAAtB,CACAO,CAAAA,CAAQH,QAAR,CAAAE,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAlC,CAAA,CAAAA,MAAAA,CADA,WACA,CAAA,CADA,CAEAe,CAAA,CAAAkB,QAAA,CAAAM,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAlC,CAAA,CAAAA,MAAAA,CAFA,cAEA,CAAA,CAFA,CATAiB,CAAa,CAAKgB,QAAQ,CAACM,CAAI,CAACL,CAAD,EAAA,CAAA,CAAA,CAAY,GAS3C,CAT+B,CAAL,CAS1B,CAIDf,CAASsB,CAATR,QAAoBE,CAAAA,CAAAA,CAApBD,CAAoBC,EAAAA,CAAenC,CAAA,CAAAA,MAAAA,CAAAA,yBAAAA,CAAfmC,CAAAA,CAAenC,CAAA,CAAAA,MAAAA,CAAAA,yBAAAA,CAJlC,CAImBmC,CAAAA,CAJnB,CAKAG,CAAA,CAAYI,CAA+B,CAL3C,CAK2C,CAL3C,CAKAvD,CAECwD,CAFDxD,KAAAA,CAAAA,CANkC,CAMlCE,CAGCuD,CAHDvD,KAAAA,CAAAA,CANkC,CAMlCC,CAICuD,CAJDvD,KAAAA,CAAAA,CANkC,CAYlC,IAAA,GACCuD,CAAAA,CADD,CAAAJ,CAAK,CAAL,CAAA,CAAUA,CAAA,CAAV,CAAA,CAAoBK,CAApB,EAAA,CACCD,CADD,CACCA,CAAaA,CAAAA,QAAU,CAAAN,CAAIK,CAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CAAaN,CAAK,CAALA,MAAAA,CAAxCO,CAA2BD,CAAJ,CAAVC,CADd,CAECL,CAAA,CAAAA,CAAA,CAFD,CAKA,IAAA,GAAAC,CAAAA,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAA,CAAA,CAAAA,CAAA,EAAA,CAAA,CAID,OAjCDJ,CAAAA,CAAA,CAAAC,CAAA,CAAAL,QAAA,CAAAM,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAI,CAAA,CAAAA,MAAAA,CA8BC,CA9BD,CAAA,CAAA,CAiCC,CAdEQ,CAAa,CAAMb,QAAQ,CAACM,CAAI,CAACL,CAAD,EAAA,CAASlC,CAAM,CAANA,MAAAA,CAAT,gBAAA,CAAyCA,CAAM,CAANA,MAAAA,CAW3E,gBAXkC,CAAL,CAc7B,CADD2C,CAAII,CAAAA,IAAAA,CAAAA,KAAAA,CAA2B5B,CAA3B4B,CAAAA,CAAAA,CAAAA,CAAAA,EAAAA,CAAAA,CAAoCb,CAApCa,MAAAA,CAAAA,6BAAAA,CAA0C/C,CAAA,CAAAA,MAAAA,CAF7C,6BAEG+C,CAAAA,CACH,CAAAH,CAAY,CAAUI,CAAA,CAAYf,CAAZ,EAAA,CAHtB,CAGsB,CAAtB,CAAAY,CACCV,CAJD,EAGA,CAGClB,CAAAA,CAHD,CAAA,CAGCA,CAAAA,CAHD,CAAA,CAG8BgB,CAH9B,EAAA,CAAAY,CAIC1B,EAAkBiB,EAAAA,CAAAA,CAAoBG,GAApBH,GAAoBG,CAJvCM,GAAAA,CAQAxD,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CACAC,CA9BA,CAlIH,CAmKIyD,CAAsBd,CAAtBc,SAAsBd,CAAtBc,CAAwC,CACxCP,GAAAA,CAAAA,CAAO,CAAPQ,IAAA,CAAAA,GAAAA,CAAAA,CAAAA,CAAAf,QAAA,CAAAM,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAM,CAAA,CAAA,CAAAQ,CAAAR,CAGDvB,CAASwB,CAATL,CAAoBD,CAAAA,QAAUM,CAAAA,CAA9B,CAAmCP,CAAnC,EAAA,CAAA,EAAA,CAHCM,EAGD,CAA8BC,CAH7BD,CAIArB,CAAIkB,CAAQD,CAAWE,CAAOL,QAASM,CAAAA,CAAKL,CAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CAJ5CM,EAI4CN,CAALK,CAJvCC,CAIAF,CAAA,CACCQ,CAAmC,CALpCN,CAKoC,CALpCA,CAIArD,CAGCyD,CAHDzD,KAAAA,CAfkB,EAWlBqD,CADwC,CAKxCnD,CAICwD,CAJDxD,KAAAA,CAAAA,CALwC,CAHzCC,CAAiB,CAAjBA,KAAAA,CAAAA,CAGyC,CAYvCuD,IAAAA,GACAR,CAAAA,CADAQ,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAU,CAAVA,CAAAA,CAAuBJ,CAAvBI,EAAAA,CACAR,CADAQ,CACAP,CAAA,CAAAL,QAAA,CAAAM,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAI,CAAA,CAAAA,MAAAA,CAAA,CAAA,CAAA,CAAA,CADAO,CAXDL,CAAO,CAAPA,CAAO,CAWNK,CAKF,IA9BD,GAAAJ,CAAAA,CAAA,CA8BC,CAAA,CA9BDA,CA8BC,CAhBCD,CAgBD,CA9BDC,CA8BC,EAAA,CA9BD,CAsCC,OALDJ,CAAAA,CAAA,CAAAC,CAAA,CAAAL,QAAA,CAAAM,CAAA,CAAAL,CAAA,EAAA,CAAA,CAAA,CAAAI,CAAA,CAAAA,MAAAA,CAAA,CAAA,CAAA,CAAA,CAKC,CAJHQ,CAAA,CAAA3B,CAAA,EAAA,EAAA,IAAA6B,IAAA,CAAAA,KAAAA,CAAAA,CAAAd,CAAAA,CAAA,EAAAc,EADE,CACF,CAAA,CAIG,CAjBEJ,CAAa,CAAMK,CAAQ,CAACf,CAY/B,EAZ8B,CAY9B,CAZ8B,CAiB7B,CAhBEW,CAAU,CAWb,EAKC,CAAIK,CAAAA,CAAJ,CAAA,CAAcC,CAAA,CAAd,CAAA,CAA0B/D,CAA1B,EAAA,CAAAyD,CACCO,EAAsBhE,EAAAA,CAAAA,CAAc,GAAdA,GAAc,CADrCyD,GAAAA,CAKAQ,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CACAH,CA/BC,CAnKJ,CA0MEV,CAAIc,CAAJd,SAAIc,CAAJd,CAAIc,CACH,GAAAJ,CAAAA,CAAW,CAACK,CAAOC,CAAPD,aAAAA,CAAZ,mCAAYA,CAAZ,CACAE,CAAEF,CAAOG,CAAAA,CAAAA,aAAAA,CADT,mCACSA,CADT,CAEAjC,CAAIkC,CAAAA,CAAcC,CAFlB,SAEID,IAFJ,CAGAE,CAJD,CAAAR,CAAA,CAAAA,aAAAA,CACC,aADDA,CACC,CAKDA,CAAIS,CAAJT,SAAAA,CAAAA,MAAAA,CAAAA,mBAAAA,CANIC,CAOHJ,CAAIa,CAAJb,WAAAA,CAAAA,CAAAA,CAPGI,CAOHO,CACCT,CADDS,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAPGP,CAOH,IAAA9B,GAAAA,CAPG8B,GAYHD,CAAAA,CAAAA,aAAAA,CAAAA,uBAAAA,EAAAA,KAAAA,CAAAA,CAZGC,CAAJ,CA1MF,CA0NGA,CAAS,CAAA,QAATA,CAAAA,CAAS,CAAA,CAAA,CAAW,CACnBD,GAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,MAAAA,CAAAA,OAAAA,CAAAA,kBAAAA,CAAAA,CACAI,CAAA,CAAAA,MAAAA,CAAAA,mBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAFmB,CAbpBhC,CAAG,CAAHA,aAAAA,CAAAA,WAAAA,CAAAA,CAAAA,CAaA,CA1NH,CAgOIqC,CAAA,CAAAA,SAAA,CAAAA,CAAA,CAAAA,CAAA,CACD,GAjBDC,CAAAA,CAAA,CAAA/E,CAAA,CAAAA,aAAAA,CAiBC,mCAjBDA,CAiBC,CAfCoE,CAAQ,CAAKpE,CAAQ,CAARA,aAAAA,CAed,mCAfcA,CAed,CAEDqE,CAAIW,CAAAA,CAAa,CAFhB,SAEGA,IAFH,CAGAH,CAAO,CAAIR,CAAD,CAACA,aAAAA,CAHX,aAGWA,CAHX,CAKA5B,CAAIkC,CAAJlC,SAAAA,CAAAA,MAAAA,CAAAA,mBAAAA,CANC,CAODsC,CAJD,CAICA,WAAAA,CAAAA,CAAAA,CAPC,CARDF,CAAS,CAATA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAQC,CAUD,IAAArC,GAAAA,CAVC,GAUD6B,CACCY,CADDZ,aAAAA,CAAAA,uBAAAA,EAAAA,KAAAA,CAAAA,CAVC,EAUD,IAAA3B,GAAAA,CAVC,GADA2B,CAAO,CAAPA,aAAAA,CAAAA,sBAAAA,EAAAA,KAAAA,CAAAA,CACA,CAAA,CAhOJ,CAmPEW,CAAIE,CAAAA,QAAJF,CAAAA,CAAIE,CAAAA,CAAAA,CAAiB,CACpBjF,GAAAA,CAAAA,CAAAA,CAAAA,CAAQ,CAARA,MAAAA,CAAAA,OAAAA,CAAAA,kBAAAA,CAAAA,CACAwE,CAAA,CAAAA,MAAAA,CAAAA,mBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAFoB,CAbpBhC,CAAG,CAAHA,aAAAA,CAAAA,WAAAA,CAAAA,CAAAA,CAaD,CAnPF,CAwPG0C,CACCC,CADDD,UAAA,CAAA,GAAAE,CAAAA,CAEIC,CAAa,GAFjB,CAAA,IAAA,CAbCL,CAAO,CAAPA,SAAW,CAAXA,CAAY,CAAA,MAAId,CAAAA,CAAC,CAADA,QAAAA,GAAAA,QAAAA,CAAAA,CAAAA,CAAJ,GAAIA,CAajB,CAAA,CAIAoB,CAAK,CAAI9B,CAAAA,CAAAA,CAAQ,CAARA,KAAAA,CAAAA,MAAAA,CACR2B,aAAcE,CAAME,CADZ/B,KAAAA,CAER,QAAA4B,CAAA,CAAA,WAAAA,EAAA,CAAA,GAAA,CAAAJ,CAAA,CAAAI,CAAA,CAAAA,QAAAA,GAAA,CAAA,CAAA,CAAA,GAAA,CAAAJ,CAAA,CAAAI,CAAA,CAAA,OAAAA,EAAA,CAAA,CAAA,GAAA,CAfWJ,CAAO,CAACI,CAAG,CAetB,QAfmBA,EAAD,CAelB,CAAA,GAAA,CAf2CJ,CAAO,CAACI,CAAG,CAetD,UAfmDA,EAAD,CAelD,CAAA,GAAA,CAf+EJ,CAAO,CAACI,CAAG,CAS3F,UATwFA,EAAD,CASvF,CAQA1E,CAAAA,CAAAA,IAAAA,CAAUqB,CAAQoD,CAAlBzE,MAAAA,CARA,CAxPH,CAuPEuE,CAAA,CAAAA,UAAA,CAeAjF,CAAA,CAAAA,SAAAA,CAAAA,MAAAA,CAAAA,eAAAA,CAJC,CAlQH,CAuPMwF,CAAS,CAATA,UAAuB,CAoB1B,OAnBIC,CAAAA,CAAU,CAAGzC,QAAQ,CAACM,CAAI,CAACS,IAAI,CAAL,MAACA,EAAD,CAAA,CAAA,CAA9B,GAA8B,CAAL,CAmBzB,CADDoB,CAAU,CAlBT,EAmBA,CAAAE,CAAIK,CAnBJ,gEAmBA,CAECrD,CAAAA,CAFD,CAAA,CAEiBmB,CAFjB,CAAA,CAAA,CAAAA,CAAA,EAAA,CAIA2B,CAAIQ,EAAON,CAAY,CAAZA,MAAAA,CAAuBvD,IAAAA,CAAAA,KAAAA,CAAlCiC,IAAA,CAAAA,MAAAA,GAAAsB,CAAA,CAAAF,MAAkCrD,CAAvBuD,CAAXF,CAfAzE,CAAS,CAATA,KAAAA,CAT0B,CAAA,CA4B1BkF,CAAEC,EA5BH,CAvPF,CA2RMC,CAAAA,CAAAA,SAAG,CAAHA,CAAiB9D,IACjB+D,CAAAA,CADiB/D,CACjB+D,CAAAA,CAAAA,EADiB/D,CAHEK,CAAA,CAInB0D,EADiB/D,CAZhB2D,CAAO,CAAY,GAAMlE,CAAI,CAAjC,WAYoBO,CAMnBgE,CAAA,CAlBD,CAYoBhE,CAOlBK,CAAA,CAnBF,CAYoBL,CASjB8D,CAAAA,CAAAA,KAAAA,CAAAA,UAAiB9D,CACjB+D,CAAAA,CAAAA,YAAAA,CAAYtE,CAHO,CAGnBsE,WAAAA,CAHmBjG,CAAA,CAGnBiG,YAAAA,CADiB/D,CAEjBiE,CAAAA,CAAAA,CAAAA,EAFiBjE,CAIjBS,IAAAA,GAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAOyD,CAAEzE,CAATgB,CAAAA,CAAcC,CAAdD,EAAAA,CANmBiD,CAAA,CAAAA,IAAAA,CAApB,GAAA,CAAA,CAAA,CAAA,CAQAQ,CAAA,CAAAA,CAAA,CAAAzE,CAAA,CAAAyE,WAAAA,CARA,CAAA,CARC3D,KAAK,CAAGd,CAAI,CAAJA,UAAAA,CAAgByE,CAAC,CAAGzE,CAAI,CAAJA,UAAAA,CAQ7B,MARSA,CAQT,CAUDmE,GAAC,CAACO,CAAW,CAVZ,aAAA,CAWDJ,IA1BD,CAAAtE,CAAA,CAeE,WAAA,CAcFwE,KAAA,CAAAxE,CAAA,CAAAK,WAdE,CAAA,CAAoB4D,EADrB,IAAK,GAAIU,CAAAA,CAAC,CAAV,CAAA,CAAgBA,CAAC,CAAG3E,CAAI,CAAJA,YAAAA,CAApB,MAAA,CAA8C2E,CAA9C,EAAA,CAmBDR,CAAES,CAAFT,IAAAA,CAAS,GAAA,CAAA,CAAA,CAAA,CACRrD,KAAA,CAAIyD,CAAAA,CAAAA,YAAAA,CAAAA,CAAAA,EADI,KAAA,CAIRF,GAAA,CAAIQ,CAAAA,CAJI,aAAA,CAfNP,IAAI,CAAQtE,CAAI,CAeV,WAAA,CAMRwE,KAAA,CAAKxE,CAAK,CANF,WAAA,CAOP0B,QAAIoD,CAPG,CAAA,CAQP9D,OAAA,CAAI8D,CAAAA,CAAAA,YAAAA,CAAAA,CAAAA,EAAJ9D,OARO,CAAA,CAATmD,EAaCI,CAAAA,CAAAA,UAAAA,CAAAA,GAAAA,CA7BEF,CATiB9D,CAjBI4D,CAAA,CAAAA,IAAAA,CAgElBY,UAhEkB,CAiEvB,GAAAR,CAAA,CAAAvE,CAAYA,CAAZuE,WAAAA,CAAkBJ,CAAA,CAAlB,MAAA,CAAkB,MAAAA,CAAAA,CAAA,CAAA,MAAAA,EAAA,CAGjB,OAnBIW,CAAAA,CAmBJ,CAFAD,CAAA,CAAuB7E,CAAvB,CAAA,CAAA,CAEA,CAAAyE,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAA,CAAA,CAAAA,CAAA,EAAA,CAnBIK,CAmBJ,CAnBkBD,CAAW,CAAXA,KAAAA,CAAAA,CAAAA,CAAlB,CAAkBA,CAmBlB,CApEsB,OAAAC,EAAAA,CAoEtB,EApEsBb,CAAA,CAAAA,CAAA,CAAAA,CAAAA,KAAAA,CAAAA,CAAAA,CAoEtB,CAdDe,CAAgB,CAAGC,CAAS,CAACD,CAAgB,CAAjB,CAAA,CAAA,CAAA,CAA0BhF,CAAI,CAAJA,YAAAA,CAAAA,MAAAA,CAAtDgF,CAA4B,CAtDL,CA0EtBT,CAAA,EA1EsBJ,CAiBJ5D,IAqElBwE,CAAAA,CArEkBxE,CAAAA,UAAAA,CAsElB,QAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,eAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CAvFsB,KAAA,IAAA,CAAA,CAuFtB,CApBA,KAAA,OAAA,CAAA,CAnEsB,CAiBJA,MAAAA,CAAAA,YAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,GAAAA,CAAAA,OAAAA,CAAAA,KAAAA,CA2EpB,SAAA,CAAA,CAAA,CAAA,CAAA,CAlBE,GAmBL,KAAA,OAAA,CAAA0E,CAAA,CAAA,KAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAAA,KAAA,IAAA,CAAA,OAAA,CAAA,MAAA,CADG,CACH,CAnBK,CAAA,CAAI,OAAA,IAAA,CAAA,OAAA,CAAkB,KAAlB,OAAA,CAAJ,CA1EsB,MA4FxB,OA5FwB,CA8EtB,GAAIC,CAAAA,CAAM,CAAIC,CAAQ,CAAQ,KAAA,IAAA,CAAhBA,IAAAA,CAAiC,KAAA,IAAA,CAA/C,GAAA,CAoBAC,CAAA,CAAKpF,CAAAA,CAAQA,CAARA,CAAAA,EAAL,KAAA,IAAA,CApBA,IAAA,CAqBA2E,CAAA,CAAAJ,CAAA,CAAA,KAAA,IAAA,CAAAA,IAAAA,CAAA,GAAA,KAAA,IAAA,CArBA,KAAA,CAwBA,MAtGsBJ,CAAAA,CAAA,CAAAA,SAAAA,CAAAA,CAAA,CAAAA,MAAAA,CAsGtB,CAtGsBA,CAAA,CAAAA,YAAAA,CAAA,KAAA,IAAA,CAAAA,KAAAA,CAsGtB,CAtGsBA,CAAA,CAAAA,MAAAA,CAAA,KAAA,IAAA,CAAAA,KAAAA,CAsGtB,CAAAA,CAAA,CAAAA,IAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAA,CAAA,MAGAA,CAxFkB5D,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,EAAAA,CA+Ed8E,CA/Ec9E,CAAAA,UAAAA,CA+FpB,QAAA,CAAA,CAAA,CAAA,CAAA,CAAe,CAAA,eAAA,CAAA,IAAA,CAAA,CAAA,CAAA,CACd,KAAA,IAAA,CAAA,CAAA,CAhGmBA,MAAAA,CAAAA,YAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,GAAAA,CAAAA,OAAAA,CAAAA,KAAAA,CAkGnB,SAAA,CAAA,CAAO+E,CACP,GAJDC,CAAAA,CAAA,CAAAhB,CAAA,CAAA,KAAA,IAAA,CAAAA,IAAAA,CAAA,KAAA,IAAA,CAIC,GAAA,CApHFiB,CAAA,CAAA,CAAAjB,CAAA,CAAA,CAAA,EAAA,KAAA,IAAA,CAAA,IAAA,CAAA,KAAA,IAAA,CAoHE,GAAA,CAIJJ,CAAA,CAAAA,SAAAA,CAAAA,CAAA,CAAAA,MAAAA,CALWmB,CAMXnB,CAAA,CAAAA,YAAAA,CAAA,KAAA,IAAA,CAAAA,KAAAA,CANWmB,CARNnB,CAAC,CAADA,MAAAA,CAAS,KAAA,IAAA,CAATA,KAAAA,CAQMmB,CAPNnB,CAAC,CAADA,IAAAA,CAAO,KAAA,IAAA,CAAPA,CAAAA,CAAAA,CAAAA,CAA4B,KAAA,IAAA,CAA5BA,CAAAA,CAAAA,CAAAA,CAeH,CA1GqB5D,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,EAAAA,CA6GbkF,CAAA,CAAAA,UAAA,CACP,GAJDC,CAAAA,CAAA,CAAApD,IAAA,CAAAA,KAAAA,CAAA6B,CAAA,CAAAA,KAAAA,CAAAnE,CAAA,CAIC,WAJDsC,CAIC,CAbEgD,CAAQ,CAAQhD,IAAI,CAAJA,IAAAA,CAAUoD,CAAQ,CAAG1F,CAAI,CAAzBsC,YAAAA,EAA0CtC,CAAI,CAYzD,YACP,CAED,MAAA,CAAA,CAHQ,CA7GJqE,CA3RN,CAqYMY,CAAS,CAATA,SAAY,CAAZA,CAAY,CAAZA,CAAY,CAAZA,CAAkC,OAetCxC,CAAAA,CAAIkD,EAAJlD,CAAAA,EAAYA,CAAA,EAAZ,CAfsC,CAelCkD,CAfkC,CAgBrClD,CAAA,CAAA,CAhBqC,CAgBxB,CAhBwB,CAiBnC,CAjBH,CArYF,CA2YMmD,CAAK,CAALA,SAAQ,CAARA,CAAQ,CAARA,CAAQ,CAARA,CAA8B,CAejC,MAAAtD,CAAAA,IAAO,CAAPA,GAAAA,CAAOA,IAAA,CAAAA,GAAAA,CAAAA,CAAAA,CAAPA,CAAOA,CAAPA,CAAA,CAAAA,CAfD,CA3YF,CA6ZIuD,CAAC,CAADA,SAAKA,CAALA,CAAKA,CAALA,CAAKA,CAALA,CAAA,CACA,MAAAC,CAAAA,CAAA,CAAA,CAAAC,CAAA,CAAA,CAAA,EAAAH,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CA9ZJ,CAAA,CAoZMD,CAAK,CAALA,SAAQ,CAARA,CAAuB,CAe3B,IAAIK,GAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAY,CAAG,WAAfA,CAAAA,CAAJ,MAAA,CAAmBjE,CAAA,CAAAkE,CAAqB,CAAxC,MAAA,CAAwClE,CAAxC,EAAA,CACI8D,CAAA,CAAAvD,IAAA,CAAAA,IAAAA,CAAOuD,CAAA,CAAAI,CAAW,CAAXA,UAAAA,CAAP3D,CAAO2D,CAAP3D,CAAAuD,UAAAvD,CADJ,CAEQuD,CAAA,CAAAA,CAAA,EAAAA,EAAAA,CAASA,CAAA,GAATA,EAFR,CAGQK,MAAC,WAAD,CACgBA,MADRC,CAAAA,CAAAA,CAAAA,IAAC,CAADA,IAAAA,CAAAN,CAAA,CAAAA,CAAA,GAAAM,EAAAA,CAAAA,UAAAA,CACQD,CAAhBE,CAAAA,CAAAA,IAAC,CAADA,IAAAA,CAAAP,CAAA,CAAAA,CAAA,GAAAO,EAAAA,CAAAA,UAAAA,CAAgBF,CAARG,CAAAA,CAAAA,CAACR,CAAA,EAADA,CAAA,GAAAQ,EAAAA,IAAAA,CAAQH,CAAAA,CADhBA,CAtaV,CAAA,CAmaMF,CAAY,CAAZA,SAAe,CAAfA,CAAe,CAAfA,CAAe,CAAfA,CAAe,CAAfA,CAAoC,CAUxC,MAAIzD,WAAW,CACV+D,GAAaC,CAAAA,CAAA,CAAAH,CAAA,EAAbE,CAAAA,CAAaE,CAAA,CAAbF,CAAJD,CAAAA,CAAIC,CAEa,MAFjBE,CAAAA,CAAA,CAAAA,CAAA,EAAAA,CAAA,EAAAA,CAAAA,CAAAA,CAAA,GAAA,EAAA,CAEiB,CAFkBN,CAAA,EAAAA,CAElB,CAFkBC,CAAA,EAAAA,CAElB,CADAC,CAAA,EAAAA,CACA,CAFjBC,CAAA,EAAAA,CAEiB,CAFjBH,CAAA,EAAAA,CAEiB,CADkBC,CAAA,CAAAA,CAAA,EAAAA,EAAAA,CAAAA,CAAA,GAAAA,EAClB,CAFjB,CAAAK,CAAA,GAAA,CAAA,EAEiB,UAHlB,CAVA,CAnaF,CAmbKC,CAAM,CAANA,SAASA,CAATA,CAASA,CAATA,CAAA,IALFA,CAAAA,CAAA,CAAAnE,IAAA,CAAAA,KAAAA,CAAA2D,CAME,iBANF3D,CAKE,CALFoE,CAUE,CAVFA,UAAA,CAAA,MAAAD,CAAAA,CAAA,CAAA,CAWCE,SAXDF,CAWCE,GAXD,kBAAA,CAWuBF,CAAAA,iBAAAA,CAXvB,EAME,CADA,CAIDhC,CAAC,CAHA,CADA,CAUFE,CAAA,CAAIiC,EATF,CADA,CAWDP,CAAA,CACMK,CAXL,EADA,CAaDN,CAAA,CAASM,CAZR,EADA,CAUEE,CAAW,CAAXA,SAAc,CAAdA,CAAc,CAAdA,CAAc,CAAdA,CAAmC,CAMvC,GAAAC,CAAAA,CAAA,CAAOC,CAAA,CAAAxE,IAAA,CAAP,EAAA,CACCyE,CAAA,CADD,EACC,EAAA,EAAKzE,IAAG0E,CAAH1E,GAAAA,CAAL,CAAKA,CAAL,CADD,CAEE+D,MAACY,CAAAA,CAAA,EAAD,EAACA,CAAA,CAAAA,CAADC,CAAA,CAAAb,CARF,CAVE,CAqBA,MAJD,WAIO,CAUR,MATE1B,EAAAA,EAAAA,CAAAA,CAAAA,CASF,EARE0B,CAAA,CAAAA,CAQF,CAZED,CAAC,CAAGM,CAAJN,EAYF,CANC3B,CAAAA,CAACoB,EAAAA,CAAAA,CAADpB,IAAAA,CAMD,EAJCE,CAAA,CAXDkB,EAAAA,CAAAA,CAAAe,IAAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAAnC,CAAA,CAAA,CAAAA,CAWCE,CAXD,CAeA,CADDF,CAAA,EAAAA,CACC,CAAA,CAVE,CArBAgC,CAnbL,CAkdGzE,CAIcmF,CAJdnF,SAIcmF,CAJdnF,CAIsC,CAJtC,GAAAoF,CAAAA,CAKCC,CAAQ9F,QAAS+F,CAAAA,CAAAA,CAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CALlB,GAKkBA,CAAAA,CALlB,CAOAD,CAAAA,CAASE,CAAAA,MAAAA,CAAAA,UAAAA,CAAAA,QAAAA,CAAAA,SAAAA,CAPT,UAOSA,CAPT,CAQAJ,CAAK,CAAA,CAAA,SAAA,CAAA,QAAA,CAAA,MAAA,CAAA,OAAA,CARL,MAQK,CARL,CAWAK,CAAI5F,CAAM6F,CAAGJ,CAAAA,QAASK,CAAAA,CAAUA,CAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CAAW9F,CAA3C,CAA2CA,MAAAA,CAX3C,CAWgC8F,CAAVA,CAATL,CAXb,CAYAK,CAAO9F,CAAAA,CAAW,CAAAL,QAAAT,CAAAA,CAAK,CAAA6G,CAAA,EAAA,CAAA,CAAA,CAAAR,CAAA,CAAAA,MAAAA,CAZvB,CAYuB,CAALrG,CAAA,CAZlB,CAYuBuG,CAAA,CAAI,GAZ3B,CAAA,WAAA,CAaAA,CAdD,CAcCA,QAAAA,CAAAA,CAAAA,EAAAA,MAAAA,CAAAA,CAAAA,CATsC,CAIkB,CAAxD,CAAI,EAAA,QAAA,CAAA,SAAA,CAAA,UAAA,EAAA,OAAA,CAAA,CAAA,CAJkC,EAWvCO,CAAAA,CAAAA,QAAAA,CAAc/F,CAAA,CAAA8F,CAAA,EAAA,CAAA,GAAA,CAAdC,EAAc,CAAdA,CAXuC,CApdxC,GAAAhG,CAAAA,CAAA,CAAAyF,CAAA,CAAAA,SAAAA,CAAAA,CAAAA,EAAA,MAAAA,EAAA,CAweA,MAAA,CAAA,CAAA,CAAA,GAAA,CAAA,SAAA,CAAA,CAAA,CAAA,MAAA,IAAA,CAAA,CAAA,CAxBE,CAldH,CAieEO,CAncG/H,UARO,CASPgI,CAAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CATO,CAAAhJ,CAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAAA,CADGC,CAAb,CAAaA,OAAAA,CAAb,SAAA,CAAA,CAAA,CAAA,MAoBEgJ,CAAAA,CAAG,CAAHA,gBAAAA,CAAAA,OAAAA,CApBF,CAoBEA,CApBWhJ,CAAAA,CACH,CAgBTN,CAAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAhBS,CAiBTK,CAAWkB,CAAXlB,OAAAA,CAAWkB,SAAAA,CAAAA,CAAAA,CAAAA,MACXjB,CAAAA,CAAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CADWiB,CACXjB,CADAD,CAAAA,CAjBS,CAqBTE,CAAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CArBS,CAsBTC,CAAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAtBS,CAsBiBK,CAAA,CAAAA,gBAAAA,CAAAA,OAAAA,CAAAA,CAAAA,CAtBjB,CAsBiBf,CAA1B,CAA0BA,gBAAAA,CAAAA,QAAAA,CAAAA,CAAAA,CAdxBuB,CAmcH+H,GAjeF,CAkeE7D,CAAS,EAleX,CAvCY,CAqhBPgE,CAAO,CAAG,QAAA,CAAA,CAAA,EAAW,CACxB,GAAIA,CAAAA,CAAO,CAAX,sGAAA,CACAC,OAAO,CAAPA,GAAAA,CAAY,KAAZA,CAAAA,CAAAA,qFAAAA,CAFD,CArhBW,CA0hBXC,CAphBAA,UAAc,CAAalK,CAAOuE,EAApB,CAA6FlE,CAA3G,EAAc,CAOb2J,CAAO,EAPR,CAohBAE,GA1hBD,CAAA,G","file":"main.min.js","sourcesContent":["\"use strict\";\n\n(function() {\n\n\t/***************************************\n\t\tCommon methods\n\t***************************************/\n\n\tvar vpWidth = function() { return Math.max(document.documentElement.clientWidth, window.innerWidth || 0); }\n\tvar vpHeight = function() { return Math.max(document.documentElement.clientHeight, window.innerHeight || 0); }\n\n\t\n\tvar init = function() {\n\t\tresizeBody();\n\t\tloom();\n\t\tcredits();\n\t}\n\n\n\n\t/***************************************\n\t\tResize body\n\t***************************************/\n\n\tvar resizeBody = function() {\n\t\tvar changeHeight = function() {\n\t\t\tdocument.documentElement.style.setProperty('--vw', (0.01 * document.body.clientWidth) + 'px');\n\t\t\tdocument.documentElement.style.setProperty('--vh', (0.01 * window.innerHeight) + 'px');\n\t\t\tdocument.body.style.height = window.innerHeight + 'px';\n\t\t}\n\n\t\tsetTimeout(changeHeight, 20); // older Safari iOS will lag\n\t\twindow.addEventListener('resize', changeHeight);\n\t}\n\n\n\n\n\n\t/***************************************\n\t\tLoom\n\t***************************************/\n\n\tvar loom = function() {\n\t\tvar sketchContainer    = document.querySelector('.sketch-container'),\n\t\t\tcontrols           = document.querySelector('.controls'),\n\t\t\tsettings           = controls.querySelector('.settings'),\n\t\t\tsettingsToggle     = settings.querySelector('.settings-toggle'),\n\t\t\tthreadWidthInput   = document.querySelector('#thread-width'),\n\t\t\tthreadSpacingInput = document.querySelector('#thread-spacing'),\n\t\t\tpatternWidthInput  = document.querySelector('#pattern-width'),\n\t\t\taddWeftBtn         = controls.querySelector('.add-weft-btn'),\n\t\t\tremoveWeftBtns     = [].slice.call(controls.querySelectorAll('.setting-wefts .remove-btn')),\n\t\t\taddWarpBtn         = controls.querySelector('.add-warp-btn'),\n\t\t\tremoveWarpBtns     = [].slice.call(controls.querySelectorAll('.setting-warps .remove-btn')),\n\t\t\tseedInput          = controls.querySelector('#seed'),\n\t\t\tgenerateBtn        = controls.querySelector('#generate'),\n\t\t\tluckyBtn           = controls.querySelector('#lucky'),\n\t\t\tdownloadBtn        = controls.querySelector('#download'),\n\t\t\targs, p5Sketch;\n\n\t\t// some fixed variables to tweak behaviour\n\t\tvar params = {\n\t\t\t\trandom: {\n\t\t\t\t\tmaxNumWefts:\t\t\t\t\t20,\n\t\t\t\t\tmaxNumWarps:\t\t\t\t\t20,\n\t\t\t\t\tmaxThreadWidth: \t\t\t\t20,\n\t\t\t\t\tpatternWidthMinMultiplier: \t\t3,\t\t\t// lower boundary for the pattern width, n * wefts number\n\t\t\t\t\tpatternWidthMaxMultiplier:\t\t10,\t\t\t// upper boundary for the pattern width, n * wefts number\n\t\t\t\t\tperlinWavelengthMinMultiplier:\t0.02,\t\t// [0, 1[ lower boundary for the Perlin Noise wavelength for the warp length\n\t\t\t\t\tperlinWavelengthMaxMultiplier:\t0.20,\t\t// ]0, 1] upper boundary for the Perlin Noise wavelength for the warp length\n\t\t\t\t\tpatternLengthMin: \t\t\t\t4,\n\t\t\t\t\tpatternLengthMax:\t\t\t\t50\n\t\t\t\t}\n\t\t\t};\n\n\n\n\t\tvar registerEvents = function() {\n\t\t\tsettingsToggle.addEventListener('click', toggleSettings);\n\t\t\taddWeftBtn.addEventListener(    'click', addWeft);\n\t\t\tremoveWeftBtns.forEach(btn =>\n\t\t\t\tbtn.addEventListener(       'click', removeWeft)\n\t\t\t);\n\t\t\taddWarpBtn.addEventListener(    'click', addWarp);\n\t\t\tremoveWarpBtns.forEach(btn =>\n\t\t\t\tbtn.addEventListener(       'click', removeWarp)\n\t\t\t);\n\n\t\t\tgenerateBtn.addEventListener(   'click', resetLoom);\n\t\t\tluckyBtn.addEventListener(      'click', luckyMode);\n\t\t\tdownloadBtn.addEventListener(   'click', saveFrame);\n\t\t\tcontrols.addEventListener(     'submit', resetLoom);\n\t\t}\n\n\t\tvar initLoom = function() {\n\t\t\targs            = parseArgs();\n\t\t\tp5Sketch        = new p5(sketch, sketchContainer);\n\t\t}\n\n\t\tvar resetLoom = function(e) {\n\t\t\tif (e)\t\t\te.preventDefault();\n\t\t\tif (p5Sketch)\tp5Sketch.remove();\n\n\t\t\tinitLoom();\n\t\t}\n\n\t\tvar parseArgs = function() {\n\t\t\tif (seedInput.value.length > 0)\n\t\t\t\tgenerateFromString(seedInput.value);\n\n\t\t\tlet threadWidth   = parseFloat(document.querySelector('#thread-width').value),\n\t\t\t\tthreadSpacing = parseFloat(document.querySelector('#thread-spacing').value),\n\t\t\t\tpatternWidth  = parseInt(document.querySelector('#pattern-width').value);\n\n\t\t\tlet weftColors    = [].slice.call(controls.querySelectorAll('.setting-wefts .repeater-elements input[type=\"color\"]'))\n\t\t\t\t\t\t\t\t  .map(input => input.value);\n\n\t\t\tlet warps         = [].slice.call(controls.querySelectorAll('.setting-warps .repeater-elements .repeater-single'))\n\t\t\t\t\t\t\t\t  .map(function(row) {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\tcolor:   row.querySelector('input[type=\"color\"]').value,\n\t\t\t\t\t\t\t\t\t\t\tpattern: row.querySelector('input[type=\"text\"]').value\n\t\t\t\t\t\t\t\t\t\t\t\t\t    .replace(/[^01]/g, '')\n\t\t\t\t\t\t\t\t\t\t\t\t\t    .split(''),\n\t\t\t\t\t\t\t\t  \t\t}\n\t\t\t\t\t\t\t\t  });\n\n\t\t\treturn {\n\t\t\t\tthreadWidth: \tthreadWidth,\n\t\t\t\tthreadSpacing:\tthreadSpacing,\n\t\t\t\tthreadTotal:    threadWidth + threadSpacing,\n\t\t\t\tpatternWidth:\tpatternWidth,\n\t\t\t\tweftColors: \tweftColors,\n\t\t\t\twarpSettings:   warps \n\t\t\t};\n\t\t}\n\n\n\t\t/***************************************\n\t\t\tPattern generation\n\t\t***************************************/\n\n\t\tvar generateFromString = function(seed) {\n\t\t//\tclear everything\n\t\t\tdocument.querySelector('.setting-wefts .repeater-elements').innerHTML = '';\n\t\t\tdocument.querySelector('.setting-warps .repeater-elements').innerHTML = '';\n\n\t\t\tlet seeder          = xmur3(seed),\n\t\t\t\tgetRandomNumber = xoshiro128ss(seeder(), seeder(), seeder(), seeder()),\n\t\t\t\talgorithms      = [\n\t\t\t\t\t\t\t\t\tgenerateFromStringRandom,\n\t\t\t\t\t\t\t\t\tgenerateFromStringLinear\n\t\t\t\t\t\t\t\t  ];\n\n\t\t\talgorithms[Math.floor(getRandomNumber() * algorithms.length)](getRandomNumber);\n\t\t}\n\n\n\t\tvar generateFromStringRandom = function(rand) {\n\t\t\tlet numWefts        = parseInt(lerp(rand(), 1, params.random.maxNumWefts)),\n\t\t\t\tnumWarps        = parseInt(lerp(rand(), 1, params.random.maxNumWarps)),\n\t\t\t\tthreadWidth     = parseInt(lerp(rand(), 1, params.random.maxThreadWidth)),\n\t\t\t\tthreadSpacing   = parseInt(lerp(rand(), 0, 0.5 * threadWidth)),\n\t\t\t\tpatternWidth    = parseInt(lerp(rand(), params.random.patternWidthMinMultiplier * numWefts, params.random.patternWidthMaxMultiplier * numWefts)),\n\t\t\t\tcolors          = generateRandomColorSet(rand);\n\n\t\t\tthreadWidthInput.value   = threadWidth;\n\t\t\tthreadSpacingInput.value = threadSpacing;\n\t\t\tpatternWidthInput.value  = patternWidth;\n\n\t\t\tfor (let i = 0; i < numWefts; i++) {\n\t\t\t\tlet newColor = colors[parseInt(lerp(rand(), 0, colors.length - 1))];\n\t\t\t\taddWeft(newColor);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < numWarps; i++) {\n\t\t\t\tlet newColor         = colors[parseInt(lerp(rand(), 0, colors.length - 1))],\n\t\t\t\t\tpatternLength    = parseInt(lerp(rand(), params.random.patternLengthMin, params.random.patternLengthMax)),\n\t\t\t\t\tperlinWavelength = Math.floor(patternWidth * lerp(rand(), params.random.perlinWavelengthMinMultiplier, params.random.perlinWavelengthMaxMultiplier)),\n\t\t\t\t\tpatternPerlin    = perlin1D(rand(), perlinWavelength),\n\t\t\t\t\tnewPattern       = '';\n\n\t\t\t\tfor (let n = 0; n < patternLength; n++) {\n\t\t\t\t\tnewPattern = newPattern + (patternPerlin() < 0.5 ? '0' : '1');\n\t\t\t\t}\n\n\t\t\t\taddWarp(newColor, newPattern);\n\t\t\t}\n\t\t}\n\n\t\tvar generateFromStringLinear = function(rand) {\n\t\t\tlet numWefts        = Math.pow(2, parseInt(lerp(rand(), 1, 5))),\n\t\t\t\tnumWarps        = numWefts,\n\t\t\t\tthreadWidth     = 2 * numWefts,\n\t\t\t\tthreadSpacing   = numWefts * parseInt(lerp(rand(), 0.1, 0.2)),\n\t\t\t\tpatternWidth    = numWefts * parseInt(lerp(rand(), 1, 10)),\n\t\t\t\tcolors          = generateRandomColorSet(rand);\n\n\t\t\tthreadWidthInput.value   = threadWidth;\n\t\t\tthreadSpacingInput.value = threadSpacing;\n\t\t\tpatternWidthInput.value  = patternWidth;\n\n\t\t\tfor (let i = 0; i < numWefts; i++) {\n\t\t\t\tlet newColor = colors[parseInt(lerp(rand(), 0, colors.length - 1))];\n\t\t\t\taddWeft(newColor);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < numWarps; i++) {\n\t\t\t\tlet newColor         = colors[parseInt(lerp(rand(), 0, colors.length - 1))],\n\t\t\t\t\tpatternLength    = patternWidth * (1 - 0.5 * (Math.floor(rand() * 3) - 1)),\n\t\t\t\t\tperlinWavelength = numWefts,\n\t\t\t\t\tpatternPerlin    = perlin1D(rand(), perlinWavelength),\n\t\t\t\t\tnewPattern       = '';\n\n\t\t\t\tfor (let n = 0; n < patternLength; n++) {\n\t\t\t\t\tnewPattern = newPattern + (patternPerlin() < 0.5 ? '0' : '1');\n\t\t\t\t}\n\n\t\t\t\taddWarp(newColor, newPattern);\n\t\t\t}\n\t\t}\n\n\n\t\t/***************************************\n\t\t\tInterface\n\t\t***************************************/\n\n\t\tvar addWeft = function(color) {\n\t\t\tlet weftsInner = controls.querySelector('.setting-wefts .repeater-elements'),\n\t\t\t\ttemplate   = controls.querySelector('.setting-wefts .repeater-template'),\n\t\t\t\tnewElem    = template.cloneNode(true),\n\t\t\t\tremoveBtn  = newElem.querySelector('.remove-btn');\n\n\t\t\tnewElem.classList.remove('repeater-template');\n\t\t\tweftsInner.appendChild(newElem);\n\t\t\tremoveBtn.addEventListener('click', removeWeft);\n\n\t\t\tif (color !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"color\"]').value = color;\n\t\t\t}\n\t\t}\n\n\t\tvar removeWeft = function(e) {\n\t\t\tlet row = e.target.closest('.repeater-single');\n\t\t\te.target.removeEventListener('click', removeWeft);\n\t\t\trow.parentElement.removeChild(row);\n\t\t}\n\n\t\tvar addWarp = function(color, pattern) {\n\t\t\tlet warpsInner = controls.querySelector('.setting-warps .repeater-elements'),\n\t\t\t\ttemplate   = controls.querySelector('.setting-warps .repeater-template'),\n\t\t\t\tnewElem    = template.cloneNode(true),\n\t\t\t\tremoveBtn  = newElem.querySelector('.remove-btn');\n\n\t\t\tnewElem.classList.remove('repeater-template');\n\t\t\twarpsInner.appendChild(newElem);\n\t\t\tremoveBtn.addEventListener('click', removeWarp);\n\n\t\t\tif (color !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"color\"]').value = color;\n\t\t\t}\n\n\t\t\tif (pattern !== null) {\n\t\t\t\tnewElem.querySelector('input[type=\"text\"]').value = pattern;\n\t\t\t}\n\t\t}\n\n\t\tvar removeWarp = function(e) {\n\t\t\tlet row = e.target.closest('.repeater-single');\n\t\t\te.target.removeEventListener('click', removeWarp);\n\t\t\trow.parentElement.removeChild(row);\n\t\t}\n\n\t\tvar saveFrame = function() {\n\t\t\tlet now      = new Date(),\n\t\t\t\tpadThis  = n => n.toString().padStart(2, '0'),\n\t\t\t\tfileName = seedInput.value.length > 0\n\t\t\t\t\t\t ? 'loom_seed_' + seedInput.value\n\t\t\t\t\t\t : 'loom_'   + now.getFullYear() + '-' + padThis(now.getMonth() + 1) + '-' + padThis(now.getDate())\n\t\t\t\t\t\t + ' ' + padThis(now.getHours()) + '-' + padThis(now.getMinutes())   + '-' + padThis(now.getSeconds());\n\t\t\tp5Sketch.save(fileName + '.jpg');\n\t\t}\n\n\t\tvar toggleSettings = function() {\n\t\t\tsettings.classList.toggle('show-settings');\n\t\t}\n\n\t\tvar luckyMode = function() {\n\t\t\tvar seedLength = parseInt(lerp(Math.random(), 1, 100)),\n\t\t\t\tseedString = '',\n    \t\t\tchars      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n\t\t\tfor (var i = 0; i < seedLength; i++) {\n\t\t\t\tseedString += chars.charAt(Math.floor(Math.random() * chars.length));\n\t\t\t}\n\n\t\t\tseedInput.value = seedString; // hacky but I don't care, it's late\n\t\t\tresetLoom();\n\t\t}\n\n\n\n\t\t/***************************************\n\t\t\tDrawing\n\t\t***************************************/\n\n\t\tvar sketch = function(p) {\n\t\t\tlet wefts         = [],\n\t\t\t\tnumWefts,\n\t\t\t\twarps         = [];\n\n\t\t\tvar\toffsetX          = 0.5 * args.threadWidth,\n\t\t\t\tcurrentY         = 0,\n\t\t\t\tcurrentWarpIndex = 0;\n\n\t\t\tp.setup = function() {\n\t\t\t\tp.createCanvas(sketchContainer.clientWidth, sketchContainer.clientHeight);\n\t\t\t\tnumWefts = getNumWefts();\n\n\t\t\t\tfor (let x = 0; x < numWefts; x++) {\n\t\t\t\t\twefts.push(new Weft({\n\t\t\t\t\t\tx:    \t\tx * args.threadTotal + offsetX, // offset because stroke is drawn centered\n\t\t\t\t\t\tcolor:\t\targs.weftColors[x % args.weftColors.length],\n\t\t\t\t\t\tgap:        args.threadSpacing,\n\t\t\t\t\t\tstep:       args.threadTotal,\n\t\t\t\t\t\twidth:\t\targs.threadWidth\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tfor (let y = 0; y < args.warpSettings.length; y++) {\n\t\t\t\t\twarps.push(new Warp({\n\t\t\t\t\t\tcolor:  \targs.warpSettings[y].color,\n\t\t\t\t\t\tgap:        args.threadSpacing,\n\t\t\t\t\t\tstep:       args.threadTotal,\n\t\t\t\t\t\twidth:  \targs.threadWidth,\n\t\t\t\t\t\tnumWefts:   numWefts,\n\t\t\t\t\t\tpattern:\targs.warpSettings[y].pattern\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tp.background(255);\n\t\t\t}\n\n\n\t\t\t/***************************************\n\t\t\t\tDraw row by row\n\t\t\t***************************************/\n\n\t\t\tp.draw = function() {\n\t\t\t\tif (currentY * args.threadTotal > p.height)\n\t\t\t\t\treturn p.noLoop();\n\n\t\t\t\tlet currentWarp = warps[currentWarpIndex];\n\n\t\t\t\tfor (var x = 0; x < numWefts; x++) {\n\t\t\t\t\tlet underOrOver = currentWarp.weave(x, currentY);\n\t\t\t\t\tif (underOrOver == 'under')\n\t\t\t\t\t \twefts[x].weave(currentY);\n\t\t\t\t}\n\n\t\t\t\tcurrentWarpIndex = wrapIndex(currentWarpIndex + 1, 0, args.warpSettings.length - 1);\n\t\t\t\tcurrentY++;\n\t\t\t}\n\n\n\t\t\t/***************************************\n\t\t\t\tWarps: horizontal threads\n\t\t\t\tToDo: flip direction on each row\n\t\t\t***************************************/\n\n\t\t\tclass Warp {\n\t\t\t\tconstructor(args) {\n\t\t\t\t\tthis.args            = args;\n\t\t\t\t\tthis.counter         = 0;\n\t\t\t\t}\n\n\t\t\t\tweave(currentX, currentY) {\n\t\t\t\t\tthis.counter = wrapIndex(this.counter + 1, 0, this.args.pattern.length - 1);\n\n\t\t\t\t//\tgo under?\n\t\t\t\t\tif (this.args.pattern[this.counter] == 0)\n\t\t\t\t\t\treturn 'under';\n\n\t\t\t\t//\tgo over!\n\t\t\t\t\tlet\tstartX =  currentX      * this.args.step - this.args.gap,\n\t\t\t\t\t\tendX   = (currentX + 1) * this.args.step,\n\t\t\t\t\t\ty      = currentY * this.args.step + 0.5 * (this.args.width);\n\n\t\t\t\t\tp.strokeCap(p.SQUARE);\n\t\t\t\t\tp.strokeWeight(this.args.width);\n\t\t\t\t\tp.stroke(this.args.color);\n\t\t\t\t\tp.line(startX, y, endX, y);\n\t\t\t\t\treturn 'over';\n\t\t\t\t}\n\t\t\t}\n\n\n\n\t\t\t/***************************************\n\t\t\t\tWefts: vertical threads\n\t\t\t***************************************/\n\n\t\t\tclass Weft {\n\t\t\t\tconstructor(args) {\n\t\t\t\t\tthis.args  = args;\n\t\t\t\t}\n\n\t\t\t\tweave(currentY) {\n\t\t\t\t\tlet startY =  currentY      * this.args.step - this.args.gap,\n\t\t\t\t\t\tendY   = (currentY + 1) * this.args.step + this.args.gap;\n\n\t\t\t\t\tp.strokeCap(p.SQUARE);\n\t\t\t\t\tp.strokeWeight(this.args.width);\n\t\t\t\t\tp.stroke(this.args.color);\n\t\t\t\t\tp.line(this.args.x, startY, this.args.x, endY);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar getNumWefts = function() {\n\t\t\t\tlet minWidth      = Math.floor(p.width / args.threadTotal),\n\t\t\t\t\tmaxWidth      = Math.ceil(minWidth / args.patternWidth) * args.patternWidth; // + Math.floor(0.5 * args.patternWidth);\n\t\t\t\treturn maxWidth;\n\t\t\t}\n\t\t}\n\n\t\t/***************************************\n\t\t\tHelper functions\n\t\t***************************************/\n\n\t\tvar wrapIndex = function(n, min, max) {\n\t\t\tif (n >= min && n <= max)\treturn n;\n\t\t\tif (n > max)\t\t\t\treturn min;\n\t\t\t\t\t\t\t\t\t\treturn max;\n\t\t}\n\n\t\tvar limit = function(n, min, max) {\n\t\t\treturn Math.min(Math.max(n, min), max);\n\t\t}\n\n\t\tvar lerp = function(n, min, max) {\n        \treturn min + (max - min) * limit(n, 0, 1);\n\t\t}\n\n\t\t// seeded pseudo-random number generator MurmurHash2, non-uniform distributions\n\t\tvar xmur3 = function(seed) {\n\t\t\tfor (var i = 0, h = 1779033703 ^ seed.length; i < seed.length; i++) {\n\t\t\t\th = Math.imul(h ^ seed.charCodeAt(i), 3432918353);\n\t\t\t\th = h << 13 | h >>> 19;\n\t\t\t}\n\n\t\t\treturn function() {\n\t\t\t\th = Math.imul(h ^ h >>> 16, 2246822507);\n\t\t\t\th = Math.imul(h ^ h >>> 13, 3266489909);\n\t\t\t\th = (h ^= h >>> 16) >>> 0;\n\t\t\t\treturn h;\n\t\t\t}\n\t\t}\n\n\t\t// seeded pseudo-random number generator xoshiro128**, uniform distribution\n\t\tvar xoshiro128ss = function(a, b, c, d) {\n\t\t    return function() {\n\t\t        var t = b << 9, r = a * 5; r = (r << 7 | r >>> 25) * 9;\n\t\t        c ^= a; d ^= b;\n\t\t        b ^= c; a ^= d; c ^= t;\n\t\t        d = d << 11 | d >>> 21;\n\t\t        return (r >>> 0) / 4294967296;\n\t\t    }\n\t\t}\n\n\t\tvar perlin1D = function(seed, wavelength) {\n\t\t\tlet M          = 1853020188851841,\t// 3^30\n\t\t\t    A          = 14348908,\t        // A - 1 has to be divisible by M's prime factors (3^15 + 1)\n\t\t\t    C          = 11, \t\t\t    // C and M are co-prime,\n\t\t\t\tZ          = Math.floor(seed * M),\n\t\t\t\trandomNum  = function() {\n\t\t\t\t\tZ = (A * Z + C) % M;\n\t\t\t\t\treturn Z / M - 0.5;\n\t\t\t\t},\n\t\t\t\th          = 1,\n\t\t\t\tx          = 0,\n\t\t\t\ty          = h / 2,\n\t\t\t\tamplitude  = 100, \t\t\t\t// amplitude\n\t\t\t\ta          = randomNum(),\n\t\t\t\tb          = randomNum();\n\n\t\t\tvar interpolate = function(pa, pb, px) {\n\t\t\t\tvar ft = px * Math.PI,\n\t\t\t\t\tf = (1 - Math.cos(ft)) * 0.5;\n\t\t\t\treturn pa * (1 - f) + pb * f;\n\t\t\t}\n\n\t\t\treturn function() {\n\t\t\t\tif (x % wavelength === 0) {\n\t\t\t\t\ta = b;\n\t\t\t\t\tb = randomNum();\n\t\t\t\t\ty = h / 2 + a * amplitude;\n\t\t\t\t} else {\n\t\t\t\t\ty = h / 2 + interpolate(a, b, (x % wavelength) / wavelength) * amplitude;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tx += 1;\n\t\t\t\treturn y;\n\t\t\t}\n\t\t}\n\n\t\tvar generateRandomColorSet = function(PRNG) {\n\t\t\tlet hue        = parseInt(lerp(PRNG(), 0, 359)),\n\t\t\t\tschemes    = ['mono', 'contrast', 'triade', 'tetrade', 'analogic'],\n\t\t\t\tvariations = ['default', 'pastel', 'soft', 'light', 'pale'],\n\t\t\t\tscheme     = schemes[parseInt(lerp(PRNG(), 0, schemes.length - 1))],\n\t\t\t\tvariation  = variations[parseInt(lerp(PRNG(), 0, variations.length - 1))],\n\t\t\t\tcolorSet   = new ColorScheme();\n\n\t\t\tcolorSet.from_hue(hue).scheme(scheme);\n\t\t\tif (['triade', 'tetrade', 'analogic'].indexOf(scheme) > -1)\n\t\t\t\tcolorSet.distance(lerp(PRNG(), 0.25, 0.5));\n\t\t\t\n\t\t\tlet colors = colorSet.variation(variation).colors();\n\t\t\treturn colors.map(color => '#' + color);\n\t\t}\n\n\t\tregisterEvents();\n\t\tluckyMode();\n\t}\n\n\n\n\n\n\n\t/***************************************\n\t\tCredits\n\t***************************************/\n\n\tvar credits = function() {\n\t\tvar credits = '**********\\n\\nThis website was built by Matthias Planitzer.\\nwww.matthias-planitzer.de\\n\\n**********';\n\t\tconsole.log('%c' + credits, 'color: #00F; font-family: Helvetica Neue\", Helvetica, sans-serif; font-size: 14px;');\t\n\t}\n\n\tinit();\n})();"]}