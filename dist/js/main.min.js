"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(){var a=function(){var a=function(){document.documentElement.style.setProperty("--vw",.01*document.body.clientWidth+"px"),document.documentElement.style.setProperty("--vh",.01*window.innerHeight+"px"),document.body.style.height=window.innerHeight+"px"};setTimeout(a,20),window.addEventListener("resize",a)},b=function(){var a,b,c=document.querySelector(".sketch-container"),d=document.querySelector(".controls"),e=d.querySelector(".settings"),f=e.querySelector(".settings-toggle"),g=d.querySelector(".add-weft-btn"),h=[].slice.call(d.querySelectorAll(".setting-wefts .remove-btn")),i=d.querySelector(".add-warp-btn"),j=[].slice.call(d.querySelectorAll(".setting-warps .remove-btn")),k=d.querySelector("#seed"),l=d.querySelector("#generate"),m=d.querySelector("#lucky"),n=d.querySelector("#download"),o=function(){a=q(),b=new p5(z,c)},p=function(a){a&&a.preventDefault(),b&&b.remove(),o()},q=function(){0<k.value.length&&r(k.value);var a=parseFloat(document.querySelector("#thread-width").value),b=parseFloat(document.querySelector("#thread-spacing").value),c=parseInt(document.querySelector("#pattern-width").value),e=[].slice.call(d.querySelectorAll(".setting-wefts .repeater-elements input[type=\"color\"]")).map(function(a){return a.value}),f=[].slice.call(d.querySelectorAll(".setting-warps .repeater-elements .repeater-single")).map(function(a){return{color:a.querySelector("input[type=\"color\"]").value,pattern:a.querySelector("input[type=\"text\"]").value.replace(/[^01]/g,"").split("")}});return{threadWidth:a,threadSpacing:b,threadTotal:a+b,patternWidth:c,weftColors:e,warpSettings:f}},r=function(a){var b=document.querySelector("#thread-width"),c=document.querySelector("#thread-spacing"),d=document.querySelector("#pattern-width");document.querySelector(".setting-wefts .repeater-elements").innerHTML="",document.querySelector(".setting-warps .repeater-elements").innerHTML="";var e=D(a),f=parseInt(C(e(),1,50)),g=parseInt(C(e(),1,50)),h=parseInt(C(e(),1,50)),j=F(e);b.value=h,c.value=parseInt(C(e(),0,.5*h)),d.value=parseInt(C(e(),3*f,10*f));for(var k,l=0;l<f;l++)k=j[parseInt(C(e(),0,j.length-1))],s(k);for(var m=0;m<g;m++){for(var o=j[parseInt(C(e(),0,j.length-1))],p=parseInt(C(e(),4,200)),q=E(e()),r="",t=0;t<p;t++)r+=.5>q()?"0":"1";u(o,r)}},s=function(a){var b=d.querySelector(".setting-wefts .repeater-elements"),c=d.querySelector(".setting-wefts .repeater-template"),e=c.cloneNode(!0),f=e.querySelector(".remove-btn");e.classList.remove("repeater-template"),b.appendChild(e),f.addEventListener("click",t),null!==a&&(e.querySelector("input[type=\"color\"]").value=a)},t=function b(a){var c=a.target.closest(".repeater-single");a.target.removeEventListener("click",b),c.parentElement.removeChild(c)},u=function(a,b){var c=d.querySelector(".setting-warps .repeater-elements"),e=d.querySelector(".setting-warps .repeater-template"),f=e.cloneNode(!0),g=f.querySelector(".remove-btn");f.classList.remove("repeater-template"),c.appendChild(f),g.addEventListener("click",v),null!==a&&(f.querySelector("input[type=\"color\"]").value=a),null!==b&&(f.querySelector("input[type=\"text\"]").value=b)},v=function b(a){var c=a.target.closest(".repeater-single");a.target.removeEventListener("click",b),c.parentElement.removeChild(c)},w=function(){var a=new Date,c=function(a){return a.toString().padStart(2,"0")},d="loom_"+a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+" "+c(a.getHours())+"-"+c(a.getMinutes())+"-"+c(a.getSeconds());b.save(d+".jpg")},x=function(){e.classList.toggle("show-settings")},y=function(){for(var a=parseInt(C(Math.random(),1,100)),b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;d<a;d++)b+=c.charAt(Math.floor(Math.random()*c.length));k.value=b,p()},z=function(b){var d,e=[],f=[],g=.5*a.threadWidth,h=0,i=0;b.setup=function(){b.createCanvas(c.clientWidth,c.clientHeight),d=l();for(var h=0;h<d;h++)e.push(new k({x:h*a.threadTotal+g,color:a.weftColors[h%a.weftColors.length],gap:a.threadSpacing,step:a.threadTotal,width:a.threadWidth}));for(var i=0;i<a.warpSettings.length;i++)f.push(new j({color:a.warpSettings[i].color,gap:a.threadSpacing,step:a.threadTotal,width:a.threadWidth,numWefts:d,pattern:a.warpSettings[i].pattern}));b.background(255)},b.draw=function(){if(h*a.threadTotal>b.height)return b.noLoop();for(var c,g=f[i],j=0;j<d;j++)c=g.weave(j,h),"under"==c&&e[j].weave(h);i=A(i+1,0,a.warpSettings.length-1),h++};var j=function(){function a(b){_classCallCheck(this,a),this.args=b,this.counter=0}return _createClass(a,[{key:"weave",value:function(a,c){if(this.counter=A(this.counter+1,0,this.args.pattern.length-1),0==this.args.pattern[this.counter])return"under";var d=a*this.args.step-this.args.gap,e=(a+1)*this.args.step,f=c*this.args.step+.5*this.args.width;return b.strokeCap(b.SQUARE),b.strokeWeight(this.args.width),b.stroke(this.args.color),b.line(d,f,e,f),"over"}}]),a}(),k=function(){function a(b){_classCallCheck(this,a),this.args=b}return _createClass(a,[{key:"weave",value:function(a){var c=a*this.args.step-this.args.gap,d=(a+1)*this.args.step+this.args.gap;b.strokeCap(b.SQUARE),b.strokeWeight(this.args.width),b.stroke(this.args.color),b.line(this.args.x,c,this.args.x,d)}}]),a}(),l=function(){var c=Math.floor(b.width/a.threadTotal),d=Math.ceil(c/a.patternWidth)*a.patternWidth+Math.floor(.5*a.patternWidth);return d}},A=function(a,b,c){return a>=b&&a<=c?a:a>c?b:c},B=function(a,b,c){return Math.min(Math.max(a,b),c)},C=function(a,b,c){return b+(c-b)*B(a,0,1)},D=function(a){for(var b=0,c=1779033703^a.length;b<a.length;b++)c=Math.imul(c^a.charCodeAt(b),3432918353),c=c<<13|c>>>19;return function(){return c=Math.imul(c^c>>>16,2246822507),c=Math.imul(c^c>>>13,3266489909),c=(c^=c>>>16)>>>0,c/Math.pow(10,c.toString().length)}},E=function(c){var d=Math.floor(c*1853020188851841),e=function(){return d=(14348908*d+11)%1853020188851841,d/1853020188851841-.5},f=0,g=1/2,h=e(),i=e(),j=function(a,b,c){var d=c*Math.PI,e=.5*(1-Math.cos(d));return a*(1-e)+b*e};return function(){return 0==f%100?(h=i,i=e(),g=1/2+100*h):g=1/2+100*j(h,i,f%100/100),f+=1,g}},F=function(a){var b=parseInt(C(a(),0,359)),c=["mono","contrast","triade","tetrade","analogic"],d=["default","pastel","soft","light","hard","pale"],e=c[parseInt(C(a(),0,c.length-1))],f=d[parseInt(C(a(),0,d.length-1))],g=new ColorScheme;g.from_hue(b).scheme(e),-1<["triade","tetrade","analogic"].indexOf(e)&&g.distance(C(a(),.25,.5));var h=g.variation(f).colors();return h.map(function(a){return"#"+a})};(function(){f.addEventListener("click",x),g.addEventListener("click",s),h.forEach(function(a){return a.addEventListener("click",t)}),i.addEventListener("click",u),j.forEach(function(a){return a.addEventListener("click",v)}),l.addEventListener("click",p),m.addEventListener("click",y),n.addEventListener("click",w),d.addEventListener("submit",p)})(),y()},c=function a(){var a="**********\n\nThis website was built by Matthias Planitzer.\nwww.matthias-planitzer.de\n\n**********";console.log("%c"+a,"color: #00F; font-family: Helvetica Neue\", Helvetica, sans-serif; font-size: 14px;")};(function(){a(),b(),c()})()})();
//# sourceMappingURL=main.min.js.map
