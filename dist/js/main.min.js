"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(){var a=function(){var a=function(){document.documentElement.style.setProperty("--vw",.01*document.body.clientWidth+"px"),document.documentElement.style.setProperty("--vh",.01*window.innerHeight+"px"),document.body.style.height=window.innerHeight+"px"};setTimeout(a,20),window.addEventListener("resize",a)},b=function(){var a,b,c=document.querySelector(".sketch-container"),d=document.querySelector(".controls"),e=d.querySelector(".settings"),f=e.querySelector(".settings-toggle"),g=document.querySelector("#thread-width"),h=document.querySelector("#thread-spacing"),j=document.querySelector("#pattern-width"),k=d.querySelector(".add-weft-btn"),l=[].slice.call(d.querySelectorAll(".setting-wefts .remove-btn")),m=d.querySelector(".add-warp-btn"),n=[].slice.call(d.querySelectorAll(".setting-warps .remove-btn")),o=d.querySelector("#seed"),p=d.querySelector("#generate"),q=d.querySelector("#lucky"),r=d.querySelector("#download"),s={random:{maxNumWefts:20,maxNumWarps:20,maxThreadWidth:20,patternWidthMinMultiplier:3,patternWidthMaxMultiplier:10,perlinWavelengthMinMultiplier:.02,perlinWavelengthMaxMultiplier:.2,patternLengthMin:4,patternLengthMax:50}},t=function(){a=v(),b=new p5(G,c)},u=function(a){a&&a.preventDefault(),b&&b.remove(),t()},v=function(){0<o.value.length&&w(o.value);var a=parseFloat(document.querySelector("#thread-width").value),b=parseFloat(document.querySelector("#thread-spacing").value),c=parseInt(document.querySelector("#pattern-width").value),e=[].slice.call(d.querySelectorAll(".setting-wefts .repeater-elements input[type=\"color\"]")).map(function(a){return a.value}),f=[].slice.call(d.querySelectorAll(".setting-warps .repeater-elements .repeater-single")).map(function(a){return{color:a.querySelector("input[type=\"color\"]").value,pattern:a.querySelector("input[type=\"text\"]").value.replace(/[^01]/g,"").split("")}});return{threadWidth:a,threadSpacing:b,threadTotal:a+b,patternWidth:c,weftColors:e,warpSettings:f}},w=function(a){document.querySelector(".setting-wefts .repeater-elements").innerHTML="",document.querySelector(".setting-warps .repeater-elements").innerHTML="";var b=K(a),c=L(b(),b(),b(),b()),d=[x,y];d[Math.floor(c()*d.length)](c)},x=function(a){var b=parseInt(J(a(),1,s.random.maxNumWefts)),c=parseInt(J(a(),1,s.random.maxNumWarps)),d=parseInt(J(a(),1,s.random.maxThreadWidth)),e=parseInt(J(a(),0,.5*d)),f=parseInt(J(a(),s.random.patternWidthMinMultiplier*b,s.random.patternWidthMaxMultiplier*b)),k=N(a);g.value=d,h.value=e,j.value=f;for(var l,m=0;m<b;m++)l=k[parseInt(J(a(),0,k.length-1))],z(l);for(var o=0;o<c;o++){for(var p=k[parseInt(J(a(),0,k.length-1))],q=parseInt(J(a(),s.random.patternLengthMin,s.random.patternLengthMax)),r=Math.floor(f*J(a(),s.random.perlinWavelengthMinMultiplier,s.random.perlinWavelengthMaxMultiplier)),t=M(a(),r),u="",v=0;v<q;v++)u+=.5>t()?"0":"1";B(p,u)}},y=function(a){var b=Math.pow(2,parseInt(J(a(),1,5))),c=b*parseInt(J(a(),.1,.2)),d=b*parseInt(J(a(),1,10)),e=N(a);g.value=2*b,h.value=c,j.value=d;for(var f,k=0;k<b;k++)f=e[parseInt(J(a(),0,e.length-1))],z(f);for(var l=0;l<b;l++){for(var m=e[parseInt(J(a(),0,e.length-1))],o=d*(1-.5*(Math.floor(3*a())-1)),p=M(a(),b),q="",r=0;r<o;r++)q+=.5>p()?"0":"1";B(m,q)}},z=function(a){var b=d.querySelector(".setting-wefts .repeater-elements"),c=d.querySelector(".setting-wefts .repeater-template"),e=c.cloneNode(!0),f=e.querySelector(".remove-btn");e.classList.remove("repeater-template"),b.appendChild(e),f.addEventListener("click",A),null!==a&&(e.querySelector("input[type=\"color\"]").value=a)},A=function b(a){var c=a.target.closest(".repeater-single");a.target.removeEventListener("click",b),c.parentElement.removeChild(c)},B=function(a,b){var c=d.querySelector(".setting-warps .repeater-elements"),e=d.querySelector(".setting-warps .repeater-template"),f=e.cloneNode(!0),g=f.querySelector(".remove-btn");f.classList.remove("repeater-template"),c.appendChild(f),g.addEventListener("click",C),null!==a&&(f.querySelector("input[type=\"color\"]").value=a),null!==b&&(f.querySelector("input[type=\"text\"]").value=b)},C=function b(a){var c=a.target.closest(".repeater-single");a.target.removeEventListener("click",b),c.parentElement.removeChild(c)},D=function(){var a=new Date,c=function(a){return a.toString().padStart(2,"0")},d=0<o.value.length?"loom_seed_"+o.value:"loom_"+a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+" "+c(a.getHours())+"-"+c(a.getMinutes())+"-"+c(a.getSeconds());b.save(d+".jpg")},E=function(){e.classList.toggle("show-settings")},F=function(){for(var a=parseInt(J(Math.random(),1,100)),b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;d<a;d++)b+=c.charAt(Math.floor(Math.random()*c.length));o.value=b,u()},G=function(b){var d,e=[],f=[],g=.5*a.threadWidth,h=0,i=0;b.setup=function(){b.createCanvas(c.clientWidth,c.clientHeight),d=l();for(var h=0;h<d;h++)e.push(new k({x:h*a.threadTotal+g,color:a.weftColors[h%a.weftColors.length],gap:a.threadSpacing,step:a.threadTotal,width:a.threadWidth}));for(var i=0;i<a.warpSettings.length;i++)f.push(new j({color:a.warpSettings[i].color,gap:a.threadSpacing,step:a.threadTotal,width:a.threadWidth,numWefts:d,pattern:a.warpSettings[i].pattern}));b.background(255)},b.draw=function(){if(h*a.threadTotal>b.height)return b.noLoop();for(var c,g=f[i],j=0;j<d;j++)c=g.weave(j,h),"under"==c&&e[j].weave(h);i=H(i+1,0,a.warpSettings.length-1),h++};var j=function(){function a(b){_classCallCheck(this,a),this.args=b,this.counter=0}return _createClass(a,[{key:"weave",value:function(a,c){if(this.counter=H(this.counter+1,0,this.args.pattern.length-1),0==this.args.pattern[this.counter])return"under";var d=a*this.args.step-this.args.gap,e=(a+1)*this.args.step,f=c*this.args.step+.5*this.args.width;return b.strokeCap(b.SQUARE),b.strokeWeight(this.args.width),b.stroke(this.args.color),b.line(d,f,e,f),"over"}}]),a}(),k=function(){function a(b){_classCallCheck(this,a),this.args=b}return _createClass(a,[{key:"weave",value:function(a){var c=a*this.args.step-this.args.gap,d=(a+1)*this.args.step+this.args.gap;b.strokeCap(b.SQUARE),b.strokeWeight(this.args.width),b.stroke(this.args.color),b.line(this.args.x,c,this.args.x,d)}}]),a}(),l=function(){var c=Math.floor(b.width/a.threadTotal),d=Math.ceil(c/a.patternWidth)*a.patternWidth;return d}},H=function(a,b,c){return a>=b&&a<=c?a:a>c?b:c},I=function(a,b,c){return Math.min(Math.max(a,b),c)},J=function(a,b,c){return b+(c-b)*I(a,0,1)},K=function(a){for(var b=0,c=1779033703^a.length;b<a.length;b++)c=Math.imul(c^a.charCodeAt(b),3432918353),c=c<<13|c>>>19;return function(){return c=Math.imul(c^c>>>16,2246822507),c=Math.imul(c^c>>>13,3266489909),c=(c^=c>>>16)>>>0,c}},L=function(e,f,g,h){return function(){var a=f<<9,b=5*e;return b=9*(b<<7|b>>>25),g^=e,h^=f,f^=g,e^=h,g^=a,h=h<<11|h>>>21,(b>>>0)/4294967296}},M=function(c,d){var e=Math.floor(c*1853020188851841),f=function(){return e=(14348908*e+11)%1853020188851841,e/1853020188851841-.5},g=0,h=1/2,i=f(),j=f(),k=function(a,b,c){var d=c*Math.PI,e=.5*(1-Math.cos(d));return a*(1-e)+b*e};return function(){return 0==g%d?(i=j,j=f(),h=1/2+100*i):h=1/2+100*k(i,j,g%d/d),g+=1,h}},N=function(a){var b=parseInt(J(a(),0,359)),c=["mono","contrast","triade","tetrade","analogic"],d=["default","pastel","soft","light","pale"],e=c[parseInt(J(a(),0,c.length-1))],f=d[parseInt(J(a(),0,d.length-1))],g=new ColorScheme;g.from_hue(b).scheme(e),-1<["triade","tetrade","analogic"].indexOf(e)&&g.distance(J(a(),.25,.5));var h=g.variation(f).colors();return h.map(function(a){return"#"+a})};(function(){f.addEventListener("click",E),k.addEventListener("click",z),l.forEach(function(a){return a.addEventListener("click",A)}),m.addEventListener("click",B),n.forEach(function(a){return a.addEventListener("click",C)}),p.addEventListener("click",u),q.addEventListener("click",F),r.addEventListener("click",D),d.addEventListener("submit",u)})(),F()},c=function a(){var a="**********\n\nThis website was built by Matthias Planitzer.\nwww.matthias-planitzer.de\n\n**********";console.log("%c"+a,"color: #00F; font-family: Helvetica Neue\", Helvetica, sans-serif; font-size: 14px;")};(function(){a(),b(),c()})()})();
//# sourceMappingURL=main.min.js.map
